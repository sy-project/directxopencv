#include "Framework.h"
#include "SolarSystemScene.h"

void SolarSystemScene::InitImage()
{
	SelIndex = new Quad(L"Textures/Resources/UI/bg/index.jpeg");
	SelIndex->scale = { 1.0f, 1.0f };
	SelIndex->pos = Vector2(CENTER_X, CENTER_Y);

	MainRun = new Quad(L"Textures/Resources/UI/bg/run.png");
	MainRun->scale = { 1.0f, 1.0f };
	MainRun->pos = Vector2(CENTER_X, CENTER_Y);

	Recipe = new Quad(L"Textures/Resources/UI/bg/recipe.png");
	Recipe->scale = { 1.0f, 1.0f };
	Recipe->pos = Vector2(CENTER_X, CENTER_Y);

	Search = new Quad(L"Textures/Resources/UI/bg/search.png");
	Search->scale = { 1.0f, 1.0f };
	Search->pos = Vector2(CENTER_X, CENTER_Y);

	Setting = new Quad(L"Textures/Resources/UI/bg/setting.jpg");
	Setting->scale = { 1.0f, 1.0f };
	Setting->pos = Vector2(CENTER_X, CENTER_Y);

	InputPop = new Quad(L"Textures/Resources/UI/pop/inputPop.jpg");
	InputPop->scale = { 1.0f, 1.0f };

	AlarmPopup = new Quad(L"Textures/Resources/UI/pop/alarm.png");
	AlarmPopup->scale = { 1.0f, 1.0f };
	AlarmPopup->pos = Vector2(CENTER_X, CENTER_Y);

	doStartPopup = new Quad(L"Textures/Resources/UI/pop/doRun.png");
	doStartPopup->scale = { 1.0f, 1.0f };
	doStartPopup->pos = Vector2(CENTER_X, CENTER_Y);

	doStopPopup = new Quad(L"Textures/Resources/UI/pop/doStop.png");
	doStopPopup->scale = { 1.0f, 1.0f };
	doStopPopup->pos = Vector2(CENTER_X, CENTER_Y);

	isRunPopup = new Quad(L"Textures/Resources/UI/pop/isRun.png");
	isRunPopup->scale = { 1.0f, 1.0f };
	isRunPopup->pos = Vector2(CENTER_X, CENTER_Y);

	noNumPopup = new Quad(L"Textures/Resources/UI/pop/nonum.png");
	noNumPopup->scale = { 1.0f, 1.0f };
	noNumPopup->pos = Vector2(CENTER_X, CENTER_Y);

	ProgramEndPopup = new Quad(L"Textures/Resources/UI/pop/programEnd.png");
	ProgramEndPopup->scale = { 1.0f, 1.0f };
	ProgramEndPopup->pos = Vector2(CENTER_X, CENTER_Y);

	WarnPopup = new Quad(L"Textures/Resources/UI/pop/warnPop.png");
	WarnPopup->scale = { 1.0f, 1.0f };
	WarnPopup->pos = Vector2(CENTER_X, CENTER_Y);

	StartCalenderPopup = new Quad(L"Textures/Resources/UI/pop/calender.png");
	StartCalenderPopup->scale = { 1.0f, 1.0f };
	StartCalenderPopup->pos = Vector2(133 + 152, WinHeight - (597 + 139));

	EndCalenderPopup = new Quad(L"Textures/Resources/UI/pop/calender.png");
	EndCalenderPopup->scale = { 1.0f, 1.0f };
	EndCalenderPopup->pos = Vector2(559 + 152, WinHeight - (597 + 139));

	recipe8 = new Quad(L"Textures/Resources/UI/bg/recipe8.png");
	recipe8->scale = { 1.0f, 1.0f };
	recipe8->pos = Vector2(930, WinHeight - (128 + 169));

	recipe9 = new Quad(L"Textures/Resources/UI/bg/recipe9.png");
	recipe9->scale = { 1.0f, 1.0f };
	recipe9->pos = Vector2(930, WinHeight - (128 + 169));

	ProgramBT = new Quad(L"Textures/Resources/UI/button/Programbutton.png");
	ProgramBT->scale = { 1.0f, 1.0f };
	ProgramBT->pos = Vector2(618 + 118, WinHeight - (80 + 36));

	ManualBT = new Quad(L"Textures/Resources/UI/button/Manualbutton.png");
	ManualBT->scale = { 1.0f, 1.0f };
	ManualBT->pos = Vector2(1098 + 118, WinHeight - (80 + 36));

	RunBT = new Quad(L"Textures/Resources/UI/button/runBT.png");
	RunBT->scale = { 1.0f, 1.0f };
	RunBT->pos = Vector2(1573 + 138, WinHeight - (68 + 79));

	StopBT = new Quad(L"Textures/Resources/UI/button/stopBT.png");
	StopBT->scale = { 1.0f, 1.0f };
	StopBT->pos = Vector2(1573 + 138, WinHeight - (318 + 79));

	DOBT1 = new Quad(L"Textures/Resources/UI/button/DO.png");
	DOBT1->scale = { 1.0f, 1.0f };
	DOBT1->pos = Vector2(1115 + 30, WinHeight - (389 + 28));

	DOBT2 = new Quad(L"Textures/Resources/UI/button/DO.png");
	DOBT2->scale = { 1.0f, 1.0f };
	DOBT2->pos = Vector2(1203 + 30, WinHeight - (389 + 28));

	DOBT3 = new Quad(L"Textures/Resources/UI/button/DO.png");
	DOBT3->scale = { 1.0f, 1.0f };
	DOBT3->pos = Vector2(1291 + 30, WinHeight - (389 + 28));

	DOBT4 = new Quad(L"Textures/Resources/UI/button/DO.png");
	DOBT4->scale = { 1.0f, 1.0f };
	DOBT4->pos = Vector2(1379 + 30, WinHeight - (389 + 28));

	DOBT5 = new Quad(L"Textures/Resources/UI/button/DO.png");
	DOBT5->scale = { 1.0f, 1.0f };
	DOBT5->pos = Vector2(1467 + 30, WinHeight - (389 + 28));

	LampBT = new Quad(L"Textures/Resources/UI/button/lamp on.png");
	LampBT->scale = { 1.0f, 1.0f };
	LampBT->pos = Vector2(1108 + 102, WinHeight - (208 + 44));

	LampLight1 = new Quad(L"Textures/Resources/UI/button/lamp.png");
	LampLight1->scale = { 1.0f, 1.0f };
	LampLight1->pos = Vector2(1372 + 16, WinHeight - (174 + 16));

	LampLight2 = new Quad(L"Textures/Resources/UI/button/lamp.png");
	LampLight2->scale = { 1.0f, 1.0f };
	LampLight2->pos = Vector2(1412 + 16, WinHeight - (174 + 16));

	LampLight3 = new Quad(L"Textures/Resources/UI/button/lamp.png");
	LampLight3->scale = { 1.0f, 1.0f };
	LampLight3->pos = Vector2(1453 + 16, WinHeight - (174 + 16));

	LampLight4 = new Quad(L"Textures/Resources/UI/button/lamp.png");
	LampLight4->scale = { 1.0f, 1.0f };
	LampLight4->pos = Vector2(1494 + 16, WinHeight - (174 + 16));

	RecipeScrollBT = new Quad(L"Textures/Resources/UI/button/recipeScrollNo.png");
	RecipeScrollBT->scale = { 1.0f, 1.0f };
	RecipeScrollBT->pos = Vector2(356 + 12, WinHeight - (173 + 20));

	RecipeLongIndex = new Quad(L"Textures/Resources/UI/button/recipeIndex.png");
	RecipeLongIndex->scale = { 1.0f, 1.0f };
	RecipeLongIndex->pos = Vector2(93 + 128, WinHeight - (169 + 2432));

	RecipeGreenLight = new Quad(L"Textures/Resources/UI/button/recipegreenbtn.png");
	RecipeGreenLight->scale = { 1.0f, 1.0f };
	RecipeGreenLight->pos = Vector2(93 + 5 + 5, WinHeight - (169 + 14 + 5));

	SettingOnCheckTempAMB = new Quad(L"Textures/Resources/UI/button/diobutton.png");
	SettingOnCheckTempAMB->scale = { 1.0f, 1.0f };
	SettingOnCheckTempAMB->pos = Vector2(1155 + 10, WinHeight - (874 + 10));

	SettingOnCheckTempTGT = new Quad(L"Textures/Resources/UI/button/diobutton.png");
	SettingOnCheckTempTGT->scale = { 1.0f, 1.0f };
	SettingOnCheckTempTGT->pos = Vector2(1155 + 10, WinHeight - (908 + 10));

	SettingOnCheckHumiAMB = new Quad(L"Textures/Resources/UI/button/diobutton.png");
	SettingOnCheckHumiAMB->scale = { 1.0f, 1.0f };
	SettingOnCheckHumiAMB->pos = Vector2(1155 + 10, WinHeight - (942 + 10));

	SettingOnCheckHumiTGT = new Quad(L"Textures/Resources/UI/button/diobutton.png");
	SettingOnCheckHumiTGT->scale = { 1.0f, 1.0f };
	SettingOnCheckHumiTGT->pos = Vector2(1155 + 10, WinHeight - (975 + 10));

	SettingOnCheckLamp = new Quad(L"Textures/Resources/UI/button/diobutton.png");
	SettingOnCheckLamp->scale = { 1.0f, 1.0f };
	SettingOnCheckLamp->pos = Vector2(1155 + 10, WinHeight - (1009 + 10));

	SettingOnCheckDO1 = new Quad(L"Textures/Resources/UI/button/diobutton.png");
	SettingOnCheckDO1->scale = { 1.0f, 1.0f };
	SettingOnCheckDO1->pos = Vector2(1300 + 10, WinHeight - (874 + 10));

	SettingOnCheckDO2 = new Quad(L"Textures/Resources/UI/button/diobutton.png");
	SettingOnCheckDO2->scale = { 1.0f, 1.0f };
	SettingOnCheckDO2->pos = Vector2(1300 + 10, WinHeight - (908 + 10));

	SettingOnCheckDO3 = new Quad(L"Textures/Resources/UI/button/diobutton.png");
	SettingOnCheckDO3->scale = { 1.0f, 1.0f };
	SettingOnCheckDO3->pos = Vector2(1300 + 10, WinHeight - (942 + 10));

	SettingOnCheckDO4 = new Quad(L"Textures/Resources/UI/button/diobutton.png");
	SettingOnCheckDO4->scale = { 1.0f, 1.0f };
	SettingOnCheckDO4->pos = Vector2(1300 + 10, WinHeight - (975 + 10));

	SettingOnCheckDO5 = new Quad(L"Textures/Resources/UI/button/diobutton.png");
	SettingOnCheckDO5->scale = { 1.0f, 1.0f };
	SettingOnCheckDO5->pos = Vector2(1300 + 10, WinHeight - (1009 + 10));

	wstring wstemp;
	for (int i = 0; i < 3; i++)
	{
		wstemp = L"Textures/Resources/UI/pop/loading" + to_wstring(i + 1) + L".png";
		Loading[i] = new Quad(wstemp);
		Loading[i]->scale = { 1.0f, 1.0f };
		Loading[i]->pos = Vector2(CENTER_X, CENTER_Y);
	}


	D3D11_TEXTURE2D_DESC desc;
	ZeroMemory(&desc, sizeof(desc));
	desc.Width = 1726;
	desc.Height = 662;
	desc.MipLevels = desc.ArraySize = 1;
	desc.Format = DXGI_FORMAT_R16G16B16A16_UINT;;
	desc.SampleDesc.Count = 1;
	desc.SampleDesc.Quality = 0;
	desc.Usage = D3D11_USAGE_DEFAULT;
	desc.BindFlags = 0;
	desc.CPUAccessFlags = D3D11_CPU_ACCESS_WRITE | D3D11_CPU_ACCESS_READ;
	desc.MiscFlags = 0;

	Device::Get()->GetSwapChain()->GetBuffer(0, __uuidof(ID3D11Texture2D), (void**)&graph.texture);
	DEVICE->CreateTexture2D(&desc, nullptr, &graph.texture);
	//DEVICE->CreateRenderTargetView(graph.texture, &renderTargetViewDesc, &graph.m_renderTargetView);

	//D3D11_SHADER_RESOURCE_VIEW_DESC shaderResourceViewDesc;
	//shaderResourceViewDesc.Format = desc.Format;
	//shaderResourceViewDesc.ViewDimension = D3D11_SRV_DIMENSION_TEXTURE2D;
	//shaderResourceViewDesc.Texture2D.MostDetailedMip = 0;
	//shaderResourceViewDesc.Texture2D.MipLevels = 1;

	//// Create the shader resource view.
	//DEVICE->CreateShaderResourceView(graph.texture, &shaderResourceViewDesc, &graph.m_shaderResourceView);
}

void SolarSystemScene::InitMain()
{
	run.mode = Manual;
	int temp = 1;
	MODBUS->send(103, (uint16_t)temp);
	for (int i = 0; i < 4; i++)
		run.LampOn[i] = false;
	for (int i = 0; i < 5; i++)
		run.DOBT[i] = false;
	run.LampPresetNum = 1;
	run.NowStep = 0;
	run.EndStep = 0;
	run.NowCycle = 0;
	run.EndCycle = 0;
	run.FullTime = 0;
	run.LampBT = false;
	run.ProgramName = "";
	run.ProgramNum = 0;
	run.RemainTime = 0;
	run.isRun = false;
}

void SolarSystemScene::InitRecipe()
{
	vector<Data> temp;
	int i = 0;
	while (true)
	{
		if (DataBase->DBLoad(temp, i, RECIPE_MAIN) == false)
			break;
		if (temp.front().Table == RECIPE_MAIN)
		{
			recipe.Name[i] = temp.front().mainRC.RECIPE_NAME;
			temp.erase(temp.begin());
		}
		if (DataBase->DBLoad(temp, i, RECIPE_REPT) == false)
			break;
		if (temp.front().Table == RECIPE_REPT)
		{
			recipe.ReptStepF[i] = temp.front().reptRC.STEP_STRT;
			recipe.ReptStepT[i] = temp.front().reptRC.STEP_END;
			recipe.ReptStepC[i] = temp.front().reptRC.REPT_CYC;
			temp.erase(temp.begin());
		}
		int j = 1;
		while (true)
		{
			if (DataBase->DBLoad(temp, i, RECIPE_CONTENTS, j) == false)
				break;
			recipe.Temp[i][j - 1] = temp.front().contRC.TEMP;
			recipe.Time[i][j - 1] = temp.front().contRC.TIME_DUR;
			//recipe.totalTime[i] += recipe.Time[i][j - 1];
			recipe.isFullStep[i] ++;
			recipe.Humi[i][j - 1] = temp.front().contRC.HUMID;
			recipe.Lamp[i][j - 1] = temp.front().contRC.LAMP_PRE;
			recipe.DO[i][j - 1] = temp.front().contRC.DO1;
			temp.erase(temp.begin());
			j++;
		}
		recipe.FullIndex = i;
		i++;
	}
	index = 0;
}

void SolarSystemScene::InitSearch()
{
	//stimer.t = 0;
	stimer.timer = time(NULL);
	//stimer.t = localtime(&stimer.timer);
	localtime_s(&stimer.t, &stimer.timer);

	search.StartDate[0] = stimer.t.tm_year + 1900;
	search.StartDate[1] = stimer.t.tm_mon + 1;
	search.StartDate[2] = stimer.t.tm_mday;
	search.EndDate[0] = stimer.t.tm_year + 1900;
	search.EndDate[1] = stimer.t.tm_mon + 1;
	search.EndDate[2] = stimer.t.tm_mday;

	search.AmbHumi = true;
	search.TarHumi = true;
	search.AmbTemp = true;
	search.TarTemp = true;
	search.LampPre = true;
	search.DO[0] = true;
	search.DO[1] = true;
	search.DO[2] = true;
	search.DO[3] = true;
	search.DO[4] = true;
}

void SolarSystemScene::InitSetting()
{
	vector<Data> temp;
	for (int i = 0; i < 10; i++)
	{
		if (DataBase->DBLoad(temp, i + 1, LAMP_PRESET))
		{
			setting.LampPre[i][0] = temp.front().presLP.WATTS;
			setting.LampPre[i][1] = temp.front().presLP.LAMP1;
			setting.LampPre[i][2] = temp.front().presLP.LAMP2;
			setting.LampPre[i][3] = temp.front().presLP.LAMP3;
			setting.LampPre[i][4] = temp.front().presLP.LAMP4;
			temp.erase(temp.begin());
		}
		temp.clear();
	}
	for (int i = 0; i < 5; i++)
	{
		if (DataBase->DBLoad(temp, i + 1, DO_PRESET))
		{
			setting.DOPre[i] = temp.front().presDO.DO_NAME;
			temp.erase(temp.begin());
		}
		temp.clear();
	}
	string settingLocation = "Textures/Resources/setting.txt";
	ifstream ifs;
	ifs.open(settingLocation);
	int sindex = 0;
	string tempstring;
	while (!ifs.eof())
	{
		try
		{
			if (sindex == 0)
				getline(ifs, setting.DataLocation);
			else if (sindex == 1)
			{
				getline(ifs, tempstring);
				setting.Password = stoi(tempstring);
			}
			else if (sindex == 2)
			{
				getline(ifs, tempstring);
				setting.SaveDataInterval = stoi(tempstring);
			}
			else if (sindex == 3)
			{
				getline(ifs, tempstring);
				setting.ComPort[sindex - 3] = stoi(tempstring);
			}
			else if (sindex == 4)
			{
				getline(ifs, tempstring);
				setting.ComPort[sindex - 3] = stoi(tempstring);
			}
			else if (sindex == 5)
			{
				getline(ifs, tempstring);
				setting.ComPort[sindex - 3] = stoi(tempstring);
			}
			else if (sindex == 6)
			{
				getline(ifs, tempstring);
				setting.ComPort[sindex - 3] = stoi(tempstring);
			}
			else if (sindex == 7)
			{
				getline(ifs, tempstring);
				setting.ComPort[sindex - 3] = stoi(tempstring);
			}
			else if (sindex == 8)
			{
				getline(ifs, tempstring);
				setting.ComPort[sindex - 3] = stoi(tempstring);
			}
			else if (sindex == 9)
			{
				getline(ifs, tempstring);
				setting.DIPre[sindex - 9] = (tempstring);
			}
			else if (sindex == 10)
			{
				getline(ifs, tempstring);
				setting.DIPre[sindex - 9] = (tempstring);
			}
			else if (sindex == 11)
			{
				getline(ifs, tempstring);
				setting.DIPre[sindex - 9] = (tempstring);
			}
			else if (sindex == 12)
			{
				getline(ifs, tempstring);
				setting.DIPre[sindex - 9] = (tempstring);
			}
			else if (sindex == 13)
			{
				getline(ifs, tempstring);
				setting.DIPre[sindex - 9] = (tempstring);
			}
			else if (sindex == 14)
			{
				getline(ifs, tempstring);
				setting.DIPre[sindex - 9] = (tempstring);
			}
			else if (sindex == 15)
			{
				getline(ifs, tempstring);
				setting.DIPre[sindex - 9] = (tempstring);
			}
			else if (sindex == 16)
			{
				getline(ifs, tempstring);
				setting.DIPre[sindex - 9] = (tempstring);
			}
			else if (sindex == 17)
			{
				getline(ifs, tempstring);
				setting.Alarm[sindex - 17] = (tempstring);
			}
			else if (sindex == 18)
			{
				getline(ifs, tempstring);
				setting.Alarm[sindex - 17] = (tempstring);
			}
			else if (sindex == 19)
			{
				getline(ifs, tempstring);
				setting.Alarm[sindex - 17] = (tempstring);
			}
			else if (sindex == 20)
			{
				getline(ifs, tempstring);
				setting.Alarm[sindex - 17] = (tempstring);
			}
			else if (sindex == 21)
			{
				getline(ifs, tempstring);
				setting.Alarm[sindex - 17] = (tempstring);
			}
			else if (sindex == 22)
			{
				getline(ifs, tempstring);
				setting.Alarm[sindex - 17] = (tempstring);
			}
			else if (sindex == 23)
			{
				getline(ifs, tempstring);
				setting.Alarm[sindex - 17] = (tempstring);
			}
			else if (sindex == 24)
			{
				getline(ifs, tempstring);
				setting.Alarm[sindex - 17] = (tempstring);
			}
			else if (sindex == 25)
			{
				getline(ifs, tempstring);
				setting.Alarm[sindex - 17] = (tempstring);
			}
			else if (sindex == 26)
			{
				getline(ifs, tempstring);
				setting.Alarm[sindex - 17] = (tempstring);
			}
			else if (sindex == 27)
			{
				getline(ifs, tempstring);
				setting.Alarm[sindex - 17] = (tempstring);
			}
			else if (sindex == 28)
			{
				getline(ifs, tempstring);
				setting.Alarm[sindex - 17] = (tempstring);
			}
			else if (sindex == 29)
			{
				getline(ifs, tempstring);
				setting.Alarm[sindex - 17] = (tempstring);
			}
			else if (sindex == 30)
			{
				getline(ifs, tempstring);
				setting.Alarm[sindex - 17] = (tempstring);
			}
			else if (sindex == 31)
			{
				getline(ifs, tempstring);
				setting.Alarm[sindex - 17] = (tempstring);
			}
			else if (sindex == 32)
			{
				getline(ifs, tempstring);
				setting.Alarm[sindex - 17] = (tempstring);
			}
			else
				break;
		}
		catch (const std::exception&)
		{
			if (sindex == 0)
				setting.DataLocation = "C:";
			else if (sindex == 1)
				setting.Password = 1111;
			else if (sindex == 2)
				setting.SaveDataInterval = 1;
			else if (sindex == 3)
				setting.ComPort[sindex - 3] = sindex - 2;
			else if (sindex == 4)
				setting.ComPort[sindex - 3] = sindex - 2;
			else if (sindex == 5)
				setting.ComPort[sindex - 3] = sindex - 2;
			else if (sindex == 6)
				setting.ComPort[sindex - 3] = sindex - 2;
			else if (sindex == 7)
				setting.ComPort[sindex - 3] = sindex - 2;
			else if (sindex == 8)
				setting.ComPort[sindex - 3] = sindex - 2;
			else if (sindex == 9)
				setting.DIPre[sindex - 9] = "";
			else if (sindex == 10)
				setting.DIPre[sindex - 9] = "";
			else if (sindex == 11)
				setting.DIPre[sindex - 9] = "";
			else if (sindex == 12)
				setting.DIPre[sindex - 9] = "";
			else if (sindex == 13)
				setting.DIPre[sindex - 9] = "";
			else if (sindex == 14)
				setting.DIPre[sindex - 9] = "";
			else if (sindex == 15)
				setting.DIPre[sindex - 9] = "";
			else if (sindex == 16)
				setting.DIPre[sindex - 9] = "";
			else if (sindex == 17)
				setting.Alarm[sindex - 17] = "";
			else if (sindex == 18)
				setting.Alarm[sindex - 17] = "";
			else if (sindex == 19)
				setting.Alarm[sindex - 17] = "";
			else if (sindex == 20)
				setting.Alarm[sindex - 17] = "";
			else if (sindex == 21)
				setting.Alarm[sindex - 17] = "";
			else if (sindex == 22)
				setting.Alarm[sindex - 17] = "";
			else if (sindex == 23)
				setting.Alarm[sindex - 17] = "";
			else if (sindex == 24)
				setting.Alarm[sindex - 17] = "";
			else if (sindex == 25)
				setting.Alarm[sindex - 17] = "";
			else if (sindex == 26)
				setting.Alarm[sindex - 17] = "";
			else if (sindex == 27)
				setting.Alarm[sindex - 17] = "";
			else if (sindex == 28)
				setting.Alarm[sindex - 17] = "";
			else if (sindex == 29)
				setting.Alarm[sindex - 17] = "";
			else if (sindex == 30)
				setting.Alarm[sindex - 17] = "";
			else if (sindex == 31)
				setting.Alarm[sindex - 17] = "";
			else if (sindex == 32)
				setting.Alarm[sindex - 17] = "";
			else
				break;
		}
		sindex++;
	}
	search.SearchClick = false;
}

SolarSystemScene::SolarSystemScene()
{
	DataBase = new cDBConnect(recipe.FullIndex);
	usb32ch = new cUSBCommu();
	usb8ch = new cUSBCommu();
	InitImage();
	InitMain();
	InitRecipe();
	InitSearch();
	InitSetting();
}

SolarSystemScene::~SolarSystemScene()
{
	delete SelIndex;
	delete MainRun;
	delete Recipe;
	delete Search;
	delete Setting;
	delete InputPop;
	delete AlarmPopup;
	delete doStartPopup;
	delete doStopPopup;
	delete isRunPopup;
	delete noNumPopup;
	delete ProgramEndPopup;
	delete WarnPopup;
	delete StartCalenderPopup;
	delete EndCalenderPopup;
	delete recipe8;
	delete recipe9;
	delete ProgramBT;
	delete ManualBT;
	delete RunBT;
	delete StopBT;
	delete DOBT1;
	delete DOBT2;
	delete DOBT3;
	delete DOBT4;
	delete DOBT5;
	delete LampBT;
	delete LampLight1;
	delete LampLight2;
	delete LampLight3;
	delete LampLight4;
	delete RecipeScrollBT;
	delete RecipeLongIndex;
	delete RecipeGreenLight;
	delete SettingOnCheckTempAMB;
	delete SettingOnCheckTempTGT;
	delete SettingOnCheckHumiAMB;
	delete SettingOnCheckHumiTGT;
	delete SettingOnCheckLamp;
	delete SettingOnCheckDO1;
	delete SettingOnCheckDO2;
	delete SettingOnCheckDO3;
	delete SettingOnCheckDO4;
	delete SettingOnCheckDO5;
	for(int i = 0; i < 3; i++)
		delete Loading[i];
	delete DataBase;
	delete usb32ch;
	delete usb8ch;
}

void SolarSystemScene::Update()
{
	InputPop->Update();
	AlarmPopup->Update();
	isRunPopup->Update();
	ProgramEndPopup->Update();
	WarnPopup->Update();
	if (ModbusData.size() > 0)
	{
		if (((ModbusData.at(0) < 1500 || ModbusData.at(0) > 65335) &&
			(ModbusData.at(1) < 1500 || ModbusData.at(1) > 65335) &&
			!(ModbusData.at(2) > 6000 || ModbusData.at(3) > 6000)))
		{
			if ((ModbusData.at(0) == 0 && ModbusData.at(1) == 0 && ModbusData.at(2) == 0 &&
				ModbusData.at(3) == 0 && ModbusData.at(4) == 0 &&
				ModbusData.at(5) == 0 && ModbusData.at(6) == 0 &&
				ModbusData.at(7) == 0 && ModbusData.at(8) == 0 &&
				ModbusData.at(9) == 0 && ModbusData.at(10) == 0 &&
				ModbusData.at(11) == 0 && ModbusData.at(12) == 0 &&
				ModbusData.at(13) == 0 && ModbusData.at(14) == 0 &&
				ModbusData.at(15) == 0 && ModbusData.at(16) == 0 &&
				ModbusData.at(17) == 0 && ModbusData.at(18) == 0 &&
				ModbusData.at(19) == 0 && ModbusData.at(20) == 0 &&
				ModbusData.at(21) == 0 && ModbusData.at(22) == 0 &&
				ModbusData.at(23) == 0 && ModbusData.at(24) == 0 &&
				ModbusData.at(25) == 0 && ModbusData.at(26) == 0 &&
				ModbusData.at(27) == 0 && ModbusData.at(28) == 0 &&
				ModbusData.at(29) == 0 && ModbusData.at(30) == 0 &&
				ModbusData.at(31) == 0 && ModbusData.at(32) == 0 &&
				ModbusData.at(33) == 0
				))
				return;
			if ((ModbusData.at(0) == 0 && ModbusData.at(1) == 0 && ModbusData.at(2) == 0 &&
				ModbusData.at(3) == 0 && ModbusData.at(4) == 0 &&
				ModbusData.at(5) == 0 && ModbusData.at(6) == 0 &&
				ModbusData.at(7) == 0
				))
				return;
			if ((ModbusData.at(0) > 65000 && ModbusData.at(1) > 65000 && ModbusData.at(2) > 65000 &&
				ModbusData.at(3) > 65000 && ModbusData.at(4) == 0 &&
				ModbusData.at(5) == 0 && ModbusData.at(6) == 0 &&
				ModbusData.at(7) == 0 && ModbusData.at(8) > 65000 &&
				ModbusData.at(9) > 65000 && ModbusData.at(10) > 65000 &&
				ModbusData.at(11) > 65000 && ModbusData.at(12) == 0 &&
				ModbusData.at(13) == 0 && ModbusData.at(14) == 0 &&
				ModbusData.at(15) == 0 && ModbusData.at(16) > 65000 &&
				ModbusData.at(17) > 65000 && ModbusData.at(18) > 65000 &&
				ModbusData.at(19) > 65000 && ModbusData.at(20) == 0 &&
				ModbusData.at(21) == 0 && ModbusData.at(22) == 0 &&
				ModbusData.at(23) == 0 && ModbusData.at(24) > 65000 &&
				ModbusData.at(25) > 65000 && ModbusData.at(26) > 65000 &&
				ModbusData.at(27) > 65000 && ModbusData.at(28) == 0 &&
				ModbusData.at(29) == 0 && ModbusData.at(30) == 0 &&
				ModbusData.at(31) == 0 && ModbusData.at(32) > 65000 &&
				ModbusData.at(33) > 65000
				))
				return;
			if ((ModbusData.at(0) > 65000 && ModbusData.at(1) > 65000 && ModbusData.at(2) > 65000 &&
				ModbusData.at(3) > 65000 && ModbusData.at(4) == 0 &&
				ModbusData.at(5) == 0 && ModbusData.at(6) == 0 &&
				ModbusData.at(7) == 0 && ModbusData.at(8) > 40000 &&
				ModbusData.at(9) > 40000 && ModbusData.at(10) > 40000 &&
				ModbusData.at(11) > 40000 && ModbusData.at(12) > 40000 &&
				ModbusData.at(13) > 40000 && ModbusData.at(14) > 500 &&
				ModbusData.at(15) == 0 && ModbusData.at(16) > 65000 &&
				ModbusData.at(17) > 65000 && ModbusData.at(18) > 65000 &&
				ModbusData.at(19) > 65000 && ModbusData.at(20) == 0 &&
				ModbusData.at(21) == 0 && ModbusData.at(22) == 0 &&
				ModbusData.at(23) == 0 && ModbusData.at(24) > 65000 &&
				ModbusData.at(25) > 65000 && ModbusData.at(26) > 65000 &&
				ModbusData.at(27) > 65000 && ModbusData.at(28) > 30000 &&
				ModbusData.at(29) > 30000 && ModbusData.at(30) > 500 &&
				ModbusData.at(31) == 0 && ModbusData.at(32) > 65000 &&
				ModbusData.at(33) > 65000
				))
				return;
			if ((ModbusData.at(0) > 3000 && ModbusData.at(1) > 3000 && ModbusData.at(2) > 3000 &&
				ModbusData.at(3) > 3000 && ModbusData.at(4) > 3000 &&
				ModbusData.at(5) > 3000 && ModbusData.at(6) > 3000 &&
				ModbusData.at(7) > 3000 && ModbusData.at(8) > 3000 &&
				ModbusData.at(9) > 3000 && ModbusData.at(10) > 3000 &&
				ModbusData.at(11) > 3000 && ModbusData.at(12) > 3000 &&
				ModbusData.at(13) > 3000 && ModbusData.at(14) > 3000 &&
				ModbusData.at(15) > 3000 && ModbusData.at(16) > 3000 &&
				ModbusData.at(17) > 3000 && ModbusData.at(18) > 3000 &&
				ModbusData.at(19) > 3000 && ModbusData.at(20) > 3000 &&
				ModbusData.at(21) > 3000 && ModbusData.at(22) > 3000 &&
				ModbusData.at(23) > 3000 && ModbusData.at(24) > 3000 &&
				ModbusData.at(25) > 3000 && ModbusData.at(26) > 3000 &&
				ModbusData.at(27) > 3000 && ModbusData.at(28) > 3000 &&
				ModbusData.at(29) > 3000 && ModbusData.at(30) > 3000 &&
				ModbusData.at(31) > 3000 && ModbusData.at(32) > 3000 &&
				ModbusData.at(33) > 3000
				))
				return;
			if ((ModbusData.at(0) > 3000 && ModbusData.at(1) > 3000 && ModbusData.at(2) > 3000 &&
				ModbusData.at(3) > 3000 && ModbusData.at(4) < 3000 &&
				ModbusData.at(5) < 3000 && ModbusData.at(6) < 3000 &&
				ModbusData.at(7) < 3000 && ModbusData.at(8) > 3000 &&
				ModbusData.at(9) > 3000 && ModbusData.at(10) > 3000 &&
				ModbusData.at(11) > 3000 && ModbusData.at(12) < 3000 &&
				ModbusData.at(13) < 3000 && ModbusData.at(14) < 3000 &&
				ModbusData.at(15) < 3000 && ModbusData.at(16) > 3000 &&
				ModbusData.at(17) > 3000 && ModbusData.at(18) > 3000 &&
				ModbusData.at(19) > 3000 && ModbusData.at(20) > 3000 &&
				ModbusData.at(21) > 3000 && ModbusData.at(22) > 3000 &&
				ModbusData.at(23) > 3000 && ModbusData.at(24) > 3000 &&
				ModbusData.at(25) > 3000 && ModbusData.at(26) > 3000 &&
				ModbusData.at(27) > 3000 && ModbusData.at(28) < 3000 &&
				ModbusData.at(29) < 3000 && ModbusData.at(30) < 3000 &&
				ModbusData.at(31) < 3000 && ModbusData.at(32) > 3000 &&
				ModbusData.at(33) > 3000
				))
				return;
			if (ModbusData.at(8) > 3000 && ModbusData.at(9) > 3000 &&
				ModbusData.at(10) > 3000 && ModbusData.at(11) > 3000)
				return;
			if (ModbusData.at(4) > 1000)
				return;
			if (ModbusData.at(5) > 1000)
				return;
			if (ModbusData.at(1) > 1500)
			{
				if (ModbusData.at(3) != 0)
					return;
				if (ModbusData.at(4) != 0)
					return;
			}
			if (ModbusData.at(0) > 1500)
			{
				if (ModbusData.at(3) != 0)
					return;
				if (ModbusData.at(4) != 0)
					return;
			}
			if (ModbusData.at(27) > 9)
				return;
			if (ModbusData.at(28) > 9)
				return;
			if (ModbusData.at(30) > ModbusData.at(31))
				return;

			//Data
			run.TempAMB = ModbusData.at(0);
			if (ModbusData.at(0) > 65330)
				run.TempAMB = run.TempAMB - 65536;
			run.TempTGT = ModbusData.at(1);
			if (ModbusData.at(1) > 65330)
				run.TempTGT = run.TempTGT - 65536;
			run.HumiAMB = ModbusData.at(4);
			run.HumiTGT = ModbusData.at(5);
			if (run.TempAMB == 0 && run.TempTGT == 0 &&
				run.HumiAMB == 0 && run.HumiTGT == 0)
			{
				cout << endl;
			}
			//Run
			if (ModbusData.at(9) == 1)
				run.isRun = false;
			else if (ModbusData.at(9) < 10 && (ModbusData.at(9) != 0))
				run.isRun = true;
			//Alarm
			run.Alarm = ModbusData.at(18);
			if (run.Alarm > 16)
				run.Alarm = 0;
			//Step Cycle
			run.NowStep = ModbusData.at(27);
			run.EndStep = ModbusData.at(28);
			run.NowCycle = ModbusData.at(30);
			run.EndCycle = ModbusData.at(31);
			//Time
			if (run.mode == Program)
			{
				//run.ProgramNum = ModbusData.at(26);
				int runStepTime = 0;
				for (int i = 0; i <= ModbusData.at(30); i++)
				{
					if (ModbusData.at(30) == 0)
					{
						for (int j = 0; j < run.NowStep - 1; j++)
						{
							runStepTime += recipe.Time[run.ProgramNum][j];
						}
					}
					else
					{
						if (i == 0)
						{
							for (int j = 0; j < run.EndStep; j++)
							{
								runStepTime += recipe.Time[run.ProgramNum][j];
							}
						}
						else if (i == ModbusData.at(30))
						{
							for (int j = run.StartStep; j < run.NowStep - 1; j++)
							{
								runStepTime += recipe.Time[run.ProgramNum][j];
							}
						}
						else
						{
							for (int j = run.StartStep; j < run.EndStep; j++)
							{
								runStepTime += recipe.Time[run.ProgramNum][j];
							}
						}
					}
				}
				run.RemainTime = run.FullTime - ((ModbusData.at(32) * 60 + ModbusData.at(33) / 60) + runStepTime);
			}
		}
		if (run.isRun == true)
		{
			sSaveData.SaveTempData.Table = MAIN_DATA;
			sSaveData.SaveTempData.mainDT.TEMP_AMB = ModbusData.at(0);
			sSaveData.SaveTempData.mainDT.TEMP_TGT = ModbusData.at(1);
			sSaveData.SaveTempData.mainDT.HUMI_AMB = ModbusData.at(4);
			sSaveData.SaveTempData.mainDT.HUMI_TGT = ModbusData.at(5);

			sSaveData.MainSaveData.push_back(sSaveData.SaveTempData);
			DataBase->DBSave(sSaveData.MainSaveData);
			sSaveData.MainSaveData.clear();
		}
	}
	if (index == 0)
	{
		SelIndex->Update();
		if (mouseClick)
		{
			isKeyInput = false;
			mouseClick = false;
			if (RangeCheck(mousePos.x, 350, 650) && RangeCheck(mousePos.y, 260, 440))
			{
				index = 1;
			}
			if (RangeCheck(mousePos.x, 810, 1110) && RangeCheck(mousePos.y, 260, 440))
			{
				index = 2;
			}
			if (RangeCheck(mousePos.x, 1270, 1570) && RangeCheck(mousePos.y, 260, 440))
			{
				KeyCase = PASSKEY;
				isKeyInput = true;
			}
			if (RangeCheck(mousePos.x, 350, 650) && RangeCheck(mousePos.y, 606, 795))
			{
				index = 4;
			}
			if (RangeCheck(mousePos.x, 810, 1110) && RangeCheck(mousePos.y, 606, 795))
			{
				FileDiaLog::OpenDirectory();
			}
			if (RangeCheck(mousePos.x, 1270, 1570) && RangeCheck(mousePos.y, 606, 795))
			{
				KeyCase = PASSKEY;
				isKeyInput = true;
			}
		}
	}
	else if (index == 1)
	{
		if (run.isRun == true)
		{
			for (int i = 0; i < 4; i++)
			{
				if (run.LampOn[i])
				{
					if (i == 0)
						LampLight1->Update();
					if (i == 1)
						LampLight2->Update();
					if (i == 2)
						LampLight3->Update();
					if (i == 3)
						LampLight4->Update();
				}
			}
			if (cyclepass)
			{
				while (true)
				{
					if (cycletemp <= run.NowCycle)
					{
						cyclepass = false;
						break;
					}
					else
					{
						if (cycletemp != run.NowCycle + 1)
							cycletemp = run.NowCycle + 1;
					}
					int sendData = 3;
					Sleep(80);
					MODBUS->send_datas(100, (uint16_t*)&sendData, 1);
					break;
				}
				Sleep(80);
			}		
			if (run.LampBT)
			{
				LampBT->Update();

				string lampSend = "\rrelay writeall ";
				if (setting.LampPre[run.LampPresetNum][1] < 50)
					lampSend += "00";
				if (setting.LampPre[run.LampPresetNum][1] <= 50)
					lampSend += "22";
				if (setting.LampPre[run.LampPresetNum][1] <= 55)
					lampSend += "33";
				if (setting.LampPre[run.LampPresetNum][1] <= 60)
					lampSend += "55";
				if (setting.LampPre[run.LampPresetNum][1] <= 65)
					lampSend += "66";
				if (setting.LampPre[run.LampPresetNum][1] <= 70)
					lampSend += "77";
				if (setting.LampPre[run.LampPresetNum][1] <= 75)
					lampSend += "99";
				if (setting.LampPre[run.LampPresetNum][1] <= 80)
					lampSend += "aa";
				if (setting.LampPre[run.LampPresetNum][1] <= 85)
					lampSend += "bb";
				if (setting.LampPre[run.LampPresetNum][1] <= 90)
					lampSend += "dd";
				if (setting.LampPre[run.LampPresetNum][1] <= 95)
					lampSend += "ee";
				if (setting.LampPre[run.LampPresetNum][1] <= 100)
					lampSend += "ff";

				if (setting.LampPre[run.LampPresetNum][2] < 50)
					lampSend += "00";
				if (setting.LampPre[run.LampPresetNum][2] <= 50)
					lampSend += "22";
				if (setting.LampPre[run.LampPresetNum][2] <= 55)
					lampSend += "33";
				if (setting.LampPre[run.LampPresetNum][2] <= 60)
					lampSend += "55";
				if (setting.LampPre[run.LampPresetNum][2] <= 65)
					lampSend += "66";
				if (setting.LampPre[run.LampPresetNum][2] <= 70)
					lampSend += "77";
				if (setting.LampPre[run.LampPresetNum][2] <= 75)
					lampSend += "99";
				if (setting.LampPre[run.LampPresetNum][2] <= 80)
					lampSend += "aa";
				if (setting.LampPre[run.LampPresetNum][2] <= 85)
					lampSend += "bb";
				if (setting.LampPre[run.LampPresetNum][2] <= 90)
					lampSend += "dd";
				if (setting.LampPre[run.LampPresetNum][2] <= 95)
					lampSend += "ee";
				if (setting.LampPre[run.LampPresetNum][2] <= 100)
					lampSend += "ff";

				if (setting.LampPre[run.LampPresetNum][3] < 50)
					lampSend += "00";
				if (setting.LampPre[run.LampPresetNum][3] <= 50)
					lampSend += "22";
				if (setting.LampPre[run.LampPresetNum][3] <= 55)
					lampSend += "33";
				if (setting.LampPre[run.LampPresetNum][3] <= 60)
					lampSend += "55";
				if (setting.LampPre[run.LampPresetNum][3] <= 65)
					lampSend += "66";
				if (setting.LampPre[run.LampPresetNum][3] <= 70)
					lampSend += "77";
				if (setting.LampPre[run.LampPresetNum][3] <= 75)
					lampSend += "99";
				if (setting.LampPre[run.LampPresetNum][3] <= 80)
					lampSend += "aa";
				if (setting.LampPre[run.LampPresetNum][3] <= 85)
					lampSend += "bb";
				if (setting.LampPre[run.LampPresetNum][3] <= 90)
					lampSend += "dd";
				if (setting.LampPre[run.LampPresetNum][3] <= 95)
					lampSend += "ee";
				if (setting.LampPre[run.LampPresetNum][3] <= 100)
					lampSend += "ff";

				if (setting.LampPre[run.LampPresetNum][4] < 50)
					lampSend += "00";
				if (setting.LampPre[run.LampPresetNum][4] <= 50)
					lampSend += "22";
				if (setting.LampPre[run.LampPresetNum][4] <= 55)
					lampSend += "33";
				if (setting.LampPre[run.LampPresetNum][4] <= 60)
					lampSend += "55";
				if (setting.LampPre[run.LampPresetNum][4] <= 65)
					lampSend += "66";
				if (setting.LampPre[run.LampPresetNum][4] <= 70)
					lampSend += "77";
				if (setting.LampPre[run.LampPresetNum][4] <= 75)
					lampSend += "99";
				if (setting.LampPre[run.LampPresetNum][4] <= 80)
					lampSend += "aa";
				if (setting.LampPre[run.LampPresetNum][4] <= 85)
					lampSend += "bb";
				if (setting.LampPre[run.LampPresetNum][4] <= 90)
					lampSend += "dd";
				if (setting.LampPre[run.LampPresetNum][4] <= 95)
					lampSend += "ee";
				if (setting.LampPre[run.LampPresetNum][4] <= 100)
					lampSend += "ff";

				lampSend += "\r\n";
				usb32ch->WriteData((char*)lampSend.c_str(), lampSend.size());

			}
			for (int i = 0; i < 5; i++)
			{
				if (run.DOBT[i])
				{
					if (i == 0)
						DOBT1->Update();
					if (i == 1)
						DOBT2->Update();
					if (i == 2)
						DOBT3->Update();
					if (i == 3)
						DOBT4->Update();
					if (i == 4)
						DOBT5->Update();
				}
			}
		}

		if (mouseClick)
		{
			isKeyInput = false;
			mouseClick = false;
			run.nonum = false;
			int sendData;
			if (run.runQeustion == true)
			{
				if (RangeCheck(mousePos.x, 660 + 80, 660 + 219) && RangeCheck(mousePos.y, 415 + 150, 415 + 214))
				{
					if (run.isRun == false)
					{
						usb32ch->Open(setting.ComPort[0]);
						usb8ch->Open(setting.ComPort[1]);
						if (run.mode == Manual)
						{
							sendData = 4;
							Sleep(80);
							(MODBUS->send_datas(100, (uint16_t*)&sendData, 1));
							usb8ch->WriteCommByte('n');
							usb32ch->WriteData((char*)"\rrelay writeall 00000000\r\n", 30);
						}
						else
						{
							vector<Data> programPush;
							vector<Data> vtemp;
							for (int i = 0; i < 9; i++)
							{
								if (DataBase->DBLoad(vtemp, run.ProgramNum, RECIPE_CONTENTS, i + 1))
								{
									programPush.push_back(vtemp.front());
									vtemp.erase(vtemp.begin());
									Loading[i]->Update();
									Loading[i]->Render();
								}
							}
							recipe.isFullStep[run.ProgramNum] = programPush.size();
							DataBase->DBLoad(vtemp, run.ProgramNum, RECIPE_REPT);
							programPush.push_back(vtemp.front());
							vtemp.erase(vtemp.begin());
							while (true)
							{
								Sleep(80);
								if (MODBUS->ProgramSet(programPush, recipe.isFullStep[run.ProgramNum]) == true)
									break;
							}
							run.FullTime = 30;
							for (int j = 0; j < recipe.ReptStepC[run.ProgramNum]; j++)
							{
								for (int i = recipe.ReptStepF[run.ProgramNum]; i <= recipe.ReptStepT[run.ProgramNum]; i++)
								{
									run.FullTime += recipe.Time[run.ProgramNum][i];
								}
							}
							sendData = 4;
							Sleep(80);
							(MODBUS->send_datas(100, (uint16_t*)&sendData, 1));
						}
						Sleep(100);
					}
				}
				run.runQeustion = false;
			}
			if (run.stopQeustion == true)
			{
				if (RangeCheck(mousePos.x, 660 + 80, 660 + 219) && RangeCheck(mousePos.y, 415 + 150, 415 + 214))
				{
					if (run.isRun == true)
					{
						run.LampBT = false;
						char SendDataTest[27] = "\rrelay writeall 00000000\r\n";
						usb32ch->WriteData(SendDataTest, 27);
						usb8ch->WriteCommByte('n');

						sendData = 1;
						usb32ch->Close();
						usb8ch->Close();
						Sleep(80);
						(MODBUS->send_datas(100, (uint16_t*)&sendData, 1));
					}
				}
				run.stopQeustion = false;
			}
			if (RangeCheck(mousePos.x, 619, 853) && RangeCheck(mousePos.y, 81, 151))
			{//프로그램 버튼
				if (run.isRun == false)
				{
					run.mode = Program;
					sendData = 0;
					while (true)
					{
						if (MODBUS->send_datas(103, (uint16_t*)&sendData, 1) == true)
							break;
					}
				}
			}
			if (RangeCheck(mousePos.x, 1098, 1332) && RangeCheck(mousePos.y, 81, 151))
			{//매뉴얼 버튼
				if (run.isRun == false)
				{
					run.mode = Manual;
					sendData = 1;
					while (true)
					{
						if (MODBUS->send_datas(103, (uint16_t*)&sendData, 1) == true)
							break;
					}
				}
			}
			if (RangeCheck(mousePos.x, 1575, 1845) && RangeCheck(mousePos.y, 70, 220))
			{//Run 버튼
				run.runQeustion = true;
			}
			if (RangeCheck(mousePos.x, 1575, 1845) && RangeCheck(mousePos.y, 320, 470))
			{//Stop 버튼
				run.stopQeustion = true;
			}
			if (RangeCheck(mousePos.x, 771, 813) && RangeCheck(mousePos.y, 415, 457))
			{//스텝 패스
				if (run.isRun == true && run.mode == Program)
				{
					sendData = 3;
					while (true)
					{
						Sleep(80);
						(MODBUS->send_datas(100, (uint16_t*)&sendData, 1));
						break;
					}
					Sleep(80);
				}
			}
			if (RangeCheck(mousePos.x, 1002, 1044) && RangeCheck(mousePos.y, 415, 457))
			{//사이클패스
				if (run.isRun == true && run.mode == Program)
				{
					cyclepass = true;
					cycletemp = run.NowCycle + 1;
					sendData = 3;
					while (true)
					{
						Sleep(80);
						(MODBUS->send_datas(100, (uint16_t*)&sendData, 1));
						break;
					}
					Sleep(80);
				}
			}
			if (RangeCheck(mousePos.x, 1111, 1311) && RangeCheck(mousePos.y, 211, 295))
			{//램프 온 버튼
				if (run.isRun == true && run.mode == Manual)
				{
					if (run.LampBT)
					{
						run.LampBT = false;
						char SendDataTest[27] = "\rrelay writeall 00000000\r\n";
						usb32ch->WriteData(SendDataTest, 27);
						//usb8ch->WriteCommByte('n');
					}
					else
					{
						run.LampBT = true;
					}
				}
			}
			if (RangeCheck(mousePos.y, 390, 442))
			{//DO 버튼
				for (int i = 0; i < 5; i++)
				{
					if (RangeCheck(mousePos.x, 1116 + i * 88, 1172 + i * 88))
					{
						if (run.DOBT[i] == false)
						{
							if (i == 0)
								usb8ch->WriteCommByte('e');
							if (i == 1)
								usb8ch->WriteCommByte('f');
							if (i == 2)
								usb8ch->WriteCommByte('g');
							if (i == 3)
								usb8ch->WriteCommByte('h');
							if (i == 4)
								usb8ch->WriteCommByte('i');
							run.DOBT[i] = true;
							break;
						}
						else if (run.DOBT[i] == true)
						{
							if (i == 0)
								usb8ch->WriteCommByte('o');
							if (i == 1)
								usb8ch->WriteCommByte('p');
							if (i == 2)
								usb8ch->WriteCommByte('q');
							if (i == 3)
								usb8ch->WriteCommByte('r');
							if (i == 4)
								usb8ch->WriteCommByte('s');
							run.DOBT[i] = false;
							break;
						}
					}
				}
			}
			//키 입력
			if (RangeCheck(mousePos.x, 382, 572) && RangeCheck(mousePos.y, 122, 248))
			{//설정 온도
				isKeyInput = true;
				KeyCase = NUMKEY;
				ClickButton[0][1] = true;
				run.isClick[0] = true;
			}
			else if (RangeCheck(mousePos.x, 382, 572) && RangeCheck(mousePos.y, 319, 445))
			{//설정 습도
				isKeyInput = true;
				KeyCase = NUMKEY;
				ClickButton[0][2] = true;
				run.isClick[1] = true;
			}
			else if (RangeCheck(mousePos.x, 952, 1054) && RangeCheck(mousePos.y, 88, 144))
			{//프로그램 넘버 설정
				if (run.isRun == false && run.mode == Program)
				{
					isKeyInput = true;
					KeyCase = NUMKEY;
					ClickButton[0][0] = true;
					run.isClick[2] = true;
					//sendData = run.ProgramNum;
					//MODBUS->send(103, (uint16_t)sendData);
				}
			}
			else if (RangeCheck(mousePos.x, 1418, 1516) && RangeCheck(mousePos.y, 211, 295))
			{
				if (run.isRun == true && run.mode == Manual)
				{
					isKeyInput = true;
					KeyCase = NUMKEY;
					ClickButton[0][4] = true;
					run.isClick[3] = true;
				}
			}
			else
			{
				isKeyInput = false;
			}
		}


		MainRun->Update();
		doStartPopup->Update();
		doStopPopup->Update();
		noNumPopup->Update();
		ProgramBT->Update();
		ManualBT->Update();
		RunBT->Update();
		StopBT->Update();
		LampLight1->Update();
		LampLight2->Update();
		LampLight3->Update();
		LampLight4->Update();
	}
	else if (index == 2)
	{
		Recipe->Update();			
		if (mouseLongClick)
		{
			//isKeyInput = false;
			if (RangeCheck(LongmousePos.x, 356, 380) && RangeCheck(LongmousePos.y, 173 + recipe.scroll, 173 + 41 + recipe.scroll))
			{
				recipe.scroll = LongmousePos.y - 193;
				if (recipe.scroll < 0)
					recipe.scroll = 0;
				if (recipe.scroll > 240)
					recipe.scroll = 240;
				RecipeScrollBT->pos.y= WinHeight - (173 + 20 + recipe.scroll);
			}
		}
		if (mouseClick)
		{
			isKeyInput = false;
			mouseClick = false;
			if (RangeCheck(mousePos.x, 93 + 21, 93 + 72) && RangeCheck(mousePos.y, 169, 473))
			{
				recipe.Apply = false;
				for (int i = 0; i < 8; i++)
				{
					if (RangeCheck(mousePos.y, 169 + 38 * i, 169 + 38 * (i + 1)))
					{
						recipe.SelIndex = recipe.scroll + i;
						if (recipe.scroll > 238)
							recipe.SelIndex = (recipe.scroll - 2) + i;
						if (recipe.FullIndex < recipe.SelIndex)
							recipe.FullIndex = recipe.SelIndex;
					}
				}
			}
			//레시피 네임
			if (RangeCheck(mousePos.y, 169, 473) && RangeCheck(mousePos.x, 93 + 79, 348))
			{
				KeyCase = BASICKEY;
				isKeyInput = true;
				recipe.NameStepCycle[recipe.SelIndex][0] = true;
			}

			//스텝, 사이클
			if (RangeCheck(mousePos.x, 289, 367) && RangeCheck(mousePos.y, 512, 554))
			{
				KeyCase = NUMKEY;
				isKeyInput = true;
				recipe.NameStepCycle[recipe.SelIndex][1] = true;
			}
			if (RangeCheck(mousePos.x, 446, 524) && RangeCheck(mousePos.y, 512, 554))
			{
				KeyCase = NUMKEY;
				isKeyInput = true;
				recipe.NameStepCycle[recipe.SelIndex][2] = true;
			}
			if (RangeCheck(mousePos.x, 667, 745) && RangeCheck(mousePos.y, 512, 554))
			{
				KeyCase = NUMKEY;
				isKeyInput = true;
				recipe.NameStepCycle[recipe.SelIndex][3] = true;
			}
			if (RangeCheck(mousePos.x, 1189, 1315) && RangeCheck(mousePos.y, 77, 119))
			{
				if (recipe.isFullStep[recipe.SelIndex] <= 7)
					recipe.isFullStep[recipe.SelIndex] = 8;
				else if (recipe.isFullStep[recipe.SelIndex] <= 8)
					recipe.isFullStep[recipe.SelIndex] = 9;
			}

			//레시피 인덱스
			if (RangeCheck(mousePos.y, 171, 465) && RangeCheck(mousePos.x, 629, 1230))
			{
				if (recipe.isFullStep[recipe.SelIndex] <= 7)
					recipe.isFullStep[recipe.SelIndex] = 7;
				else if (recipe.isFullStep[recipe.SelIndex] <= 8)
					recipe.isFullStep[recipe.SelIndex] = 8;
				else
					recipe.isFullStep[recipe.SelIndex] = 9;

				for (int x = 0; x < recipe.isFullStep[recipe.SelIndex]; x++)
				{
					for (int y = 0; y < 5; y++)
					{
						if (recipe.isFullStep[recipe.SelIndex] == 7)
						{
							if (RangeCheck(mousePos.x, 629 + x * 86, 629 + (x + 1) * 86) && RangeCheck(mousePos.y, 171 + y * 43, 171 + (y + 1) * 43))
							{
								KeyCase = NUMKEY;
								isKeyInput = true;
								recipe.isSelIndex[recipe.SelIndex][x][y] = true;
							}
						}
						if (recipe.isFullStep[recipe.SelIndex] == 8)
						{
							if (RangeCheck(mousePos.x, 629 + x * 75, 629 + (x + 1) * 75) && RangeCheck(mousePos.y, 171 + y * 43, 171 + (y + 1) * 43))
							{
								KeyCase = NUMKEY;
								isKeyInput = true;
								recipe.isSelIndex[recipe.SelIndex][x][y] = true;
							}
						}
						if (recipe.isFullStep[recipe.SelIndex] == 9)
						{
							if (RangeCheck(mousePos.x, 629 + x * 67, 629 + (x + 1) * 67) && RangeCheck(mousePos.y, 171 + y * 43, 171 + (y + 1) * 43))
							{
								KeyCase = NUMKEY;
								isKeyInput = true;
								recipe.isSelIndex[recipe.SelIndex][x][y] = true;
							}
						}
					}
				}
			}

			//레시피 세이브, 어플라이, 델레트 버튼
			if (RangeCheck(mousePos.x, 1389, 1517) && RangeCheck(mousePos.y, 498, 568))
			{//어플라이
				recipe.Apply = true;

			}
			if (RangeCheck(mousePos.x, 1540, 1668) && RangeCheck(mousePos.y, 498, 568))
			{//세이브
				//덮어쓰기 위한 삭제
				sSaveData.SaveTempData.Table = RECIPE_MAIN;
				sSaveData.SaveTempData.mainRC.RECIPE_NO = recipe.SelIndex;
				sSaveData.SaveTempData.mainRC.RECIPE_NAME = recipe.Name[recipe.SelIndex];
				DataBase->DBDel(RECIPE_MAIN, recipe.SelIndex);
				recipe.SaveRecipe.push_back(sSaveData.SaveTempData);

				sSaveData.SaveTempData.Table = RECIPE_CONTENTS;
				sSaveData.SaveTempData.contRC.RECIPE_NO = recipe.SelIndex;
				DataBase->DBDel(RECIPE_CONTENTS, recipe.SelIndex);

				//데이터 저장 시작
				for (int step = 1; step < 10; step++)
				{//인덱스
					if (recipe.Time[recipe.SelIndex][step - 1] < 1)
						break;
					sSaveData.SaveTempData.contRC.RECIPE_ST = step;
					sSaveData.SaveTempData.contRC.TEMP = recipe.Temp[recipe.SelIndex][step - 1];
					sSaveData.SaveTempData.contRC.TIME_DUR = recipe.Time[recipe.SelIndex][step - 1];
					sSaveData.SaveTempData.contRC.HUMID = recipe.Humi[recipe.SelIndex][step - 1];
					sSaveData.SaveTempData.contRC.LAMP_PRE = recipe.Lamp[recipe.SelIndex][step - 1];
					sSaveData.SaveTempData.contRC.DO1 = 0;
					sSaveData.SaveTempData.contRC.DO2 = 0;
					sSaveData.SaveTempData.contRC.DO3 = 0;
					sSaveData.SaveTempData.contRC.DO4 = 0;
					sSaveData.SaveTempData.contRC.DO5 = 0;
					if (recipe.DO[recipe.SelIndex][step - 1] == 1)
						sSaveData.SaveTempData.contRC.DO1 = 1;
					if (recipe.DO[recipe.SelIndex][step - 1] == 2)
						sSaveData.SaveTempData.contRC.DO2 = 1;
					if (recipe.DO[recipe.SelIndex][step - 1] == 3)
						sSaveData.SaveTempData.contRC.DO3 = 1;
					if (recipe.DO[recipe.SelIndex][step - 1] == 4)
						sSaveData.SaveTempData.contRC.DO4 = 1;
					if (recipe.DO[recipe.SelIndex][step - 1] == 5)
						sSaveData.SaveTempData.contRC.DO5 = 1;
					recipe.SaveRecipe.push_back(sSaveData.SaveTempData);
				}

				//반복 횟수
				sSaveData.SaveTempData.reptRC.RECIPE_NO = recipe.SelIndex;
				sSaveData.SaveTempData.reptRC.STEP_STRT = recipe.ReptStepF[recipe.SelIndex];
				sSaveData.SaveTempData.reptRC.STEP_END = recipe.ReptStepT[recipe.SelIndex];
				sSaveData.SaveTempData.reptRC.REPT_CYC = recipe.ReptStepC[recipe.SelIndex];
				DataBase->DBDel(RECIPE_REPT, recipe.SelIndex);
				recipe.SaveRecipe.push_back(sSaveData.SaveTempData);

				DataBase->DBSave(recipe.SaveRecipe);
			}
			if (RangeCheck(mousePos.x, 1694, 1822) && RangeCheck(mousePos.y, 498, 568))
			{//델레트
				DataBase->DBDel(RECIPE_MAIN, recipe.SelIndex);
				DataBase->DBDel(RECIPE_CONTENTS, recipe.SelIndex);
				DataBase->DBDel(RECIPE_REPT, recipe.SelIndex);

				recipe.Name[recipe.SelIndex] = "";
				recipe.ReptStepF[recipe.SelIndex] = 0;
				recipe.ReptStepT[recipe.SelIndex] = 0;
				recipe.ReptStepC[recipe.SelIndex] = 0;
				recipe.totalTime[recipe.SelIndex] = 0;

				for (int i = 0; i < 9; i++)
				{
					recipe.Temp[recipe.SelIndex][i] = 0;
					recipe.Time[recipe.SelIndex][i] = 0;
					recipe.Humi[recipe.SelIndex][i] = 0;
					recipe.Lamp[recipe.SelIndex][i] = 0;
					recipe.DO[recipe.SelIndex][i] = 0;
					for (int j = 0; j < 5; j++)
					{
						recipe.isSelIndex[recipe.SelIndex][i][j] = false;
					}
				}
				recipe.SelIndex--;
			}
		}
		//RecipeLongIndex->pos.y= WinHeight - (169 + 2432 - recipe.scroll * 38);
		RecipeGreenLight->pos.y= WinHeight - (169 + 14 + 5 - recipe.scroll * 38 + recipe.SelIndex * 38);

		recipe8->Update();
		recipe9->Update();

		if (recipe.Apply == true)
		{/*
			graph.LarghGraph[recipe.SelIndex]->Update();
			graph.MiniGraph[recipe.SelIndex]->Update();*/
		}

		RecipeScrollBT->Update();
		RecipeLongIndex->Update();
		RecipeGreenLight->Update();
	}
	else if (index == 4)
	{
		if (mouseClick)
		{
			mouseClick = false;
			//시작 날짜
			if (RangeCheck(mousePos.x, 137, 435) && RangeCheck(mousePos.y, 875, 939))
			{
				search.Calender[0] = true;
				search.Calender[1] = false;
			}
			if (search.Calender[0] == true)
			{
				if (RangeCheck(mousePos.x, 133, 437) && RangeCheck(mousePos.y, 597, 939))
				{
					if (RangeCheck(mousePos.x, 133 + 12, 133 + 33) && RangeCheck(mousePos.y, 16 + 597, 42 + 597))
						search.StartDate[0]--;
					else if (RangeCheck(mousePos.x, 133 + 39, 133 + 60) && RangeCheck(mousePos.y, 16 + 597, 42 + 597))
						search.StartDate[1]--;
					else if (RangeCheck(mousePos.x, 133 + 272, 133 + 292) && RangeCheck(mousePos.y, 16 + 597, 42 + 597))
						search.StartDate[0]++;
					else if (RangeCheck(mousePos.x, 133 + 244, 133 + 265) && RangeCheck(mousePos.y, 16 + 597, 42 + 597))
						search.StartDate[1]++;

					if (search.StartDate[1] > 12)
					{
						search.StartDate[0]++;
						search.StartDate[1] = 1;
					}
					if (search.StartDate[1] < 1)
					{
						search.StartDate[0]--;
						search.StartDate[1] = 12;
					}

					int calenderY = 0;
					int calenderX = 1;
					int startDay1 = 0;
					for (int i = 0; i < weekDay(search.StartDate[0], search.StartDate[1], 1); i++)
					{
						startDay1++;
					}
					if (RangeCheck(mousePos.x, 133 + 8, 133 + 294) && RangeCheck(mousePos.y, 597, 258 + 597))
					{
						for (int x_ = 1; x_ < lastDay(search.StartDate[0], search.StartDate[1]) + 1; x_++)
						{
							if (RangeCheck(mousePos.x, 133 + 8 + 42 * (calenderX - 1) + 42 * startDay1, 133 + 8 + 42 * (calenderX)+42 * startDay1) &&
								RangeCheck(mousePos.y, 59 + 34 * calenderY + 597, 59 + 34 * (calenderY + 1) + 597))
							{
								search.StartDate[2] = x_;
								search.Calender[0] = false;
							}
							if (weekDay(search.StartDate[0], search.StartDate[1], x_) == 6 && lastDay(search.StartDate[0], search.StartDate[1]) != x_)
							{
								calenderX = 0;
								calenderY++;
								startDay1 = 0;
							}
							calenderX++;
						}
					}
				}
				else
				{
					search.Calender[0] = false;
				}
			}
			//종료 날짜
			if (RangeCheck(mousePos.x, 563, 861) && RangeCheck(mousePos.y, 875, 939))
			{
				search.Calender[1] = true;
				search.Calender[0] = false;
			}
			if (search.Calender[1] == true)
			{
				if (RangeCheck(mousePos.x, 559, 863) && RangeCheck(mousePos.y, 597, 939))
				{
					if (RangeCheck(mousePos.x, 559 + 12, 559 + 33) && RangeCheck(mousePos.y, 16 + 597, 42 + 597))
						search.EndDate[0]--;
					else if (RangeCheck(mousePos.x, 559 + 39, 559 + 60) && RangeCheck(mousePos.y, 16 + 597, 42 + 597))
						search.EndDate[1]--;
					else if (RangeCheck(mousePos.x, 559 + 272, 559 + 292) && RangeCheck(mousePos.y, 16 + 597, 42 + 597))
						search.EndDate[0]++;
					else if (RangeCheck(mousePos.x, 559 + 244, 559 + 265) && RangeCheck(mousePos.y, 16 + 597, 42 + 597))
						search.EndDate[1]++;

					if (search.EndDate[1] > 12)
					{
						search.EndDate[0]++;
						search.EndDate[1] = 1;
					}
					if (search.EndDate[1] < 1)
					{
						search.EndDate[0]--;
						search.EndDate[1] = 12;
					}

					int calenderY = 0;
					int calenderX = 1;
					int startDay1 = 0;
					for (int i = 0; i < weekDay(search.EndDate[0], search.EndDate[1], 1); i++)
					{
						startDay1++;
					}
					if (RangeCheck(mousePos.x, 559 + 8, 559 + 294) && RangeCheck(mousePos.y, 597, 258 + 597))
					{
						for (int x_ = 1; x_ < lastDay(search.EndDate[0], search.EndDate[1]) + 1; x_++)
						{
							if (RangeCheck(mousePos.x, 559 + 6 + 42 * (calenderX - 1) + 42 * startDay1, 559 + 6 + 42 * (calenderX)+42 * startDay1) &&
								RangeCheck(mousePos.y, 57 + 34 * calenderY + 597, 57 + 34 * (calenderY + 1) + 597))
							{
								search.EndDate[2] = x_;
								search.Calender[1] = false;
							}
							if (weekDay(search.EndDate[0], search.EndDate[1], x_) == 6 && lastDay(search.EndDate[0], search.EndDate[1]) != x_)
							{
								calenderX = 0;
								calenderY++;
								startDay1 = 0;
							}
							calenderX++;
						}
					}
				}
				else
				{
					search.Calender[1] = false;
				}
			}
			//검색
			if (RangeCheck(mousePos.x, 351, 648) && RangeCheck(mousePos.y, 958, 1020))
			{
				search.Data.clear();
				search.SearchClick = true;
				if (search.EndDate[0] == search.StartDate[0])
				{
					if (search.EndDate[1] == search.StartDate[1])
					{
						if (search.EndDate[2] == search.StartDate[2])
						{
							int id = 1;
							while (true)
							{
								if (!DataBase->DBLoad(search.Data, id, MAIN_DATA, search.StartDate[0], search.StartDate[1], search.StartDate[2]))
								{
									break;
								}
								else
								{
									SettingOnCheckTempAMB->Update();
									SettingOnCheckTempTGT->Update();
									SettingOnCheckHumiAMB->Update();
									SettingOnCheckHumiTGT->Update();
									SettingOnCheckLamp->Update();
									SettingOnCheckDO1->Update();
									SettingOnCheckDO2->Update();
									SettingOnCheckDO3->Update();
									SettingOnCheckDO4->Update();
									SettingOnCheckDO5->Update();

									SettingOnCheckTempAMB->Render();
									SettingOnCheckTempTGT->Render();
									SettingOnCheckHumiAMB->Render();
									SettingOnCheckHumiTGT->Render();
									SettingOnCheckLamp->Render();
									SettingOnCheckDO1->Render();
									SettingOnCheckDO2->Render();
									SettingOnCheckDO3->Render();
									SettingOnCheckDO4->Render();
									SettingOnCheckDO5->Render();

									for (int date = 0; date < 3; date++)
									{
										Textpos.x = 137 + date * 100;
										Textpos.y = 875;
										Textend.x = 236 + date * 100;
										Textend.y = 939;

										wstring text = to_wstring(search.StartDate[date]);
										RECT rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

										DirectWrite::Get()->RenderText(text, rect);

										Textpos.x = 563 + date * 100;
										Textend.x = 662 + date * 100;
										text = to_wstring(search.EndDate[date]);
										rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

										DirectWrite::Get()->RenderText(text, rect);
									}

									Loading[id % 3]->Update();
									Loading[id % 3]->Render();
									id++;
								}
							}
						}
						else
						{
							for (int i = search.StartDate[2]; i <= search.EndDate[2]; i++)
							{
								int id = 1;
								while (true)
								{
									if (!DataBase->DBLoad(search.Data, id, MAIN_DATA, search.StartDate[0], search.StartDate[1], search.StartDate[2]))
									{
										break;
									}
									else
									{
										SettingOnCheckTempAMB->Update();
										SettingOnCheckTempTGT->Update();
										SettingOnCheckHumiAMB->Update();
										SettingOnCheckHumiTGT->Update();
										SettingOnCheckLamp->Update();
										SettingOnCheckDO1->Update();
										SettingOnCheckDO2->Update();
										SettingOnCheckDO3->Update();
										SettingOnCheckDO4->Update();
										SettingOnCheckDO5->Update();

										SettingOnCheckTempAMB->Render();
										SettingOnCheckTempTGT->Render();
										SettingOnCheckHumiAMB->Render();
										SettingOnCheckHumiTGT->Render();
										SettingOnCheckLamp->Render();
										SettingOnCheckDO1->Render();
										SettingOnCheckDO2->Render();
										SettingOnCheckDO3->Render();
										SettingOnCheckDO4->Render();
										SettingOnCheckDO5->Render();

										for (int date = 0; date < 3; date++)
										{
											Textpos.x = 137 + date * 100;
											Textpos.y = 875;
											Textend.x = 236 + date * 100;
											Textend.y = 939;

											wstring text = to_wstring(search.StartDate[date]);
											RECT rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

											DirectWrite::Get()->RenderText(text, rect);

											Textpos.x = 563 + date * 100;
											Textend.x = 662 + date * 100;
											text = to_wstring(search.EndDate[date]);
											rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

											DirectWrite::Get()->RenderText(text, rect);
										}

										Loading[id % 3]->Update();
										Loading[id % 3]->Render();
										id++;
									}
								}
							}
						}
					}
					else if (search.EndDate[1] >= search.StartDate[1])
					{
						for (int i = search.StartDate[1]; i <= search.EndDate[1]; i++)
						{
							int temp = lastDay(search.StartDate[0], i);
							if (i == search.StartDate[1])
							{
								for (int j = search.StartDate[2]; j <= temp; j++)
								{
									int id = 1;
									while (true)
									{
										if (!DataBase->DBLoad(search.Data, id, MAIN_DATA, search.StartDate[0], i, j))
										{
											break;
										}
										else
										{
											SettingOnCheckTempAMB->Update();
											SettingOnCheckTempTGT->Update();
											SettingOnCheckHumiAMB->Update();
											SettingOnCheckHumiTGT->Update();
											SettingOnCheckLamp->Update();
											SettingOnCheckDO1->Update();
											SettingOnCheckDO2->Update();
											SettingOnCheckDO3->Update();
											SettingOnCheckDO4->Update();
											SettingOnCheckDO5->Update();

											SettingOnCheckTempAMB->Render();
											SettingOnCheckTempTGT->Render();
											SettingOnCheckHumiAMB->Render();
											SettingOnCheckHumiTGT->Render();
											SettingOnCheckLamp->Render();
											SettingOnCheckDO1->Render();
											SettingOnCheckDO2->Render();
											SettingOnCheckDO3->Render();
											SettingOnCheckDO4->Render();
											SettingOnCheckDO5->Render();

											for (int date = 0; date < 3; date++)
											{
												Textpos.x = 137 + date * 100;
												Textpos.y = 875;
												Textend.x = 236 + date * 100;
												Textend.y = 939;

												wstring text = to_wstring(search.StartDate[date]);
												RECT rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

												DirectWrite::Get()->RenderText(text, rect);

												Textpos.x = 563 + date * 100;
												Textend.x = 662 + date * 100;
												text = to_wstring(search.EndDate[date]);
												rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

												DirectWrite::Get()->RenderText(text, rect);
											}

											Loading[id % 3]->Update();
											Loading[id % 3]->Render();
											id++;
										}
									}
								}
							}
							else if (i == search.EndDate[1])
							{
								for (int j = 1; j <= search.EndDate[2]; j++)
								{
									int id = 1;
									while (true)
									{
										if (!DataBase->DBLoad(search.Data, id, MAIN_DATA, search.StartDate[0], i, j))
										{
											break;
										}
										else
										{
											SettingOnCheckTempAMB->Update();
											SettingOnCheckTempTGT->Update();
											SettingOnCheckHumiAMB->Update();
											SettingOnCheckHumiTGT->Update();
											SettingOnCheckLamp->Update();
											SettingOnCheckDO1->Update();
											SettingOnCheckDO2->Update();
											SettingOnCheckDO3->Update();
											SettingOnCheckDO4->Update();
											SettingOnCheckDO5->Update();

											SettingOnCheckTempAMB->Render();
											SettingOnCheckTempTGT->Render();
											SettingOnCheckHumiAMB->Render();
											SettingOnCheckHumiTGT->Render();
											SettingOnCheckLamp->Render();
											SettingOnCheckDO1->Render();
											SettingOnCheckDO2->Render();
											SettingOnCheckDO3->Render();
											SettingOnCheckDO4->Render();
											SettingOnCheckDO5->Render();

											for (int date = 0; date < 3; date++)
											{
												Textpos.x = 137 + date * 100;
												Textpos.y = 875;
												Textend.x = 236 + date * 100;
												Textend.y = 939;
												wstring text = to_wstring(search.StartDate[date]);
												RECT rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

												DirectWrite::Get()->RenderText(text, rect);

												Textpos.x = 563 + date * 100;
												Textend.x = 662 + date * 100;
												text = to_wstring(search.EndDate[date]);
												rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

												DirectWrite::Get()->RenderText(text, rect);
											}

											Loading[id % 3]->Update();
											Loading[id % 3]->Render();
											id++;
										}
									}
								}
							}
							else
							{
								for (int j = 1; j <= temp; j++)
								{
									int id = 1;
									while (true)
									{
										if (!DataBase->DBLoad(search.Data, id, MAIN_DATA, search.StartDate[0], i, j))
										{
											break;
										}
										else
										{
											SettingOnCheckTempAMB->Update();
											SettingOnCheckTempTGT->Update();
											SettingOnCheckHumiAMB->Update();
											SettingOnCheckHumiTGT->Update();
											SettingOnCheckLamp->Update();
											SettingOnCheckDO1->Update();
											SettingOnCheckDO2->Update();
											SettingOnCheckDO3->Update();
											SettingOnCheckDO4->Update();
											SettingOnCheckDO5->Update();

											SettingOnCheckTempAMB->Render();
											SettingOnCheckTempTGT->Render();
											SettingOnCheckHumiAMB->Render();
											SettingOnCheckHumiTGT->Render();
											SettingOnCheckLamp->Render();
											SettingOnCheckDO1->Render();
											SettingOnCheckDO2->Render();
											SettingOnCheckDO3->Render();
											SettingOnCheckDO4->Render();
											SettingOnCheckDO5->Render();

											for (int date = 0; date < 3; date++)
											{
												Textpos.x = 137 + date * 100;
												Textpos.y = 875;
												Textend.x = 236 + date * 100;
												Textend.y = 939;
												wstring text = to_wstring(search.StartDate[date]);
												RECT rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

												DirectWrite::Get()->RenderText(text, rect);

												Textpos.x = 563 + date * 100;
												Textend.x = 662 + date * 100;
												text = to_wstring(search.EndDate[date]);
												rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

												DirectWrite::Get()->RenderText(text, rect);
											}

											Loading[id % 3]->Update();
											Loading[id % 3]->Render();
											id++;
										}
									}
								}
							}
						}
					}
				}
				else if (search.EndDate[0] >= search.StartDate[0])
				{
					int tempy = search.EndDate[0] - search.StartDate[0];
					int tempm = search.EndDate[1] - search.StartDate[1] + 12 * tempy;
					for (int i = search.StartDate[0]; i <= search.EndDate[0]; i++)
					{
						for (int j = search.StartDate[1]; j <= tempm; j++)
						{
							if (j <= 12)
							{
								if (search.StartDate[1] == j)
								{
									for (int k = search.StartDate[2]; k <= lastDay(i, j); k++)
									{
										int id = 1;
										while (true)
										{
											if (!DataBase->DBLoad(search.Data, id, MAIN_DATA, i, j, k))
											{
												break;
											}
											else
											{
												SettingOnCheckTempAMB->Update();
												SettingOnCheckTempTGT->Update();
												SettingOnCheckHumiAMB->Update();
												SettingOnCheckHumiTGT->Update();
												SettingOnCheckLamp->Update();
												SettingOnCheckDO1->Update();
												SettingOnCheckDO2->Update();
												SettingOnCheckDO3->Update();
												SettingOnCheckDO4->Update();
												SettingOnCheckDO5->Update();

												SettingOnCheckTempAMB->Render();
												SettingOnCheckTempTGT->Render();
												SettingOnCheckHumiAMB->Render();
												SettingOnCheckHumiTGT->Render();
												SettingOnCheckLamp->Render();
												SettingOnCheckDO1->Render();
												SettingOnCheckDO2->Render();
												SettingOnCheckDO3->Render();
												SettingOnCheckDO4->Render();
												SettingOnCheckDO5->Render();

												for (int date = 0; date < 3; date++)
												{
													Textpos.x = 137 + date * 100;
													Textpos.y = 875;
													Textend.x = 236 + date * 100;
													Textend.y = 939;
													wstring text = to_wstring(search.StartDate[date]);
													RECT rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

													DirectWrite::Get()->RenderText(text, rect);

													Textpos.x = 563 + date * 100;
													Textend.x = 662 + date * 100;
													text = to_wstring(search.EndDate[date]);
													rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

													DirectWrite::Get()->RenderText(text, rect);
												}

												Loading[id % 3]->Update();
												Loading[id % 3]->Render();
												id++;
											}
										}
									}
								}
								else
								{
									for (int k = 1; k <= lastDay(i, j); k++)
									{
										int id = 1;
										while (true)
										{
											if (!DataBase->DBLoad(search.Data, id, MAIN_DATA, i, j, k))
											{
												break;
											}
											else
											{
												SettingOnCheckTempAMB->Update();
												SettingOnCheckTempTGT->Update();
												SettingOnCheckHumiAMB->Update();
												SettingOnCheckHumiTGT->Update();
												SettingOnCheckLamp->Update();
												SettingOnCheckDO1->Update();
												SettingOnCheckDO2->Update();
												SettingOnCheckDO3->Update();
												SettingOnCheckDO4->Update();
												SettingOnCheckDO5->Update();

												SettingOnCheckTempAMB->Render();
												SettingOnCheckTempTGT->Render();
												SettingOnCheckHumiAMB->Render();
												SettingOnCheckHumiTGT->Render();
												SettingOnCheckLamp->Render();
												SettingOnCheckDO1->Render();
												SettingOnCheckDO2->Render();
												SettingOnCheckDO3->Render();
												SettingOnCheckDO4->Render();
												SettingOnCheckDO5->Render();

												for (int date = 0; date < 3; date++)
												{
													Textpos.x = 137 + date * 100;
													Textpos.y = 875;
													Textend.x = 236 + date * 100;
													Textend.y = 939;
													wstring text = to_wstring(search.StartDate[date]);
													RECT rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

													DirectWrite::Get()->RenderText(text, rect);

													Textpos.x = 563 + date * 100;
													Textend.x = 662 + date * 100;
													text = to_wstring(search.EndDate[date]);
													rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

													DirectWrite::Get()->RenderText(text, rect);
												}

												Loading[id % 3]->Update();
												Loading[id % 3]->Render();
												id++;
											}
										}
									}
								}
							}
							else
							{
								int a = j % 12;
								if (j % 12 == 0)
								{
									a = 12;
								}
								if (i == search.EndDate[0])
								{
									for (int k = 1; k <= search.EndDate[2]; k++)
									{
										int id = 1;
										while (true)
										{
											if (!DataBase->DBLoad(search.Data, id, MAIN_DATA, i, a, k))
											{
												break;
											}
											else
											{
												SettingOnCheckTempAMB->Update();
												SettingOnCheckTempTGT->Update();
												SettingOnCheckHumiAMB->Update();
												SettingOnCheckHumiTGT->Update();
												SettingOnCheckLamp->Update();
												SettingOnCheckDO1->Update();
												SettingOnCheckDO2->Update();
												SettingOnCheckDO3->Update();
												SettingOnCheckDO4->Update();
												SettingOnCheckDO5->Update();

												SettingOnCheckTempAMB->Render();
												SettingOnCheckTempTGT->Render();
												SettingOnCheckHumiAMB->Render();
												SettingOnCheckHumiTGT->Render();
												SettingOnCheckLamp->Render();
												SettingOnCheckDO1->Render();
												SettingOnCheckDO2->Render();
												SettingOnCheckDO3->Render();
												SettingOnCheckDO4->Render();
												SettingOnCheckDO5->Render();

												for (int date = 0; date < 3; date++)
												{
													Textpos.x = 137 + date * 100;
													Textpos.y = 875;
													Textend.x = 236 + date * 100;
													Textend.y = 939;
													wstring text = to_wstring(search.StartDate[date]);
													RECT rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

													DirectWrite::Get()->RenderText(text, rect);

													Textpos.x = 563 + date * 100;
													Textend.x = 662 + date * 100;
													text = to_wstring(search.EndDate[date]);
													rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

													DirectWrite::Get()->RenderText(text, rect);
												}

												Loading[id % 3]->Update();
												Loading[id % 3]->Render();
												id++;
											}
										}
									}
								}
								else
								{
									for (int k = 1; k <= lastDay(i, j); k++)
									{
										int id = 1;
										while (true)
										{
											if (!DataBase->DBLoad(search.Data, id, MAIN_DATA, i, a, k))
											{
												break;
											}
											else
											{
												SettingOnCheckTempAMB->Update();
												SettingOnCheckTempTGT->Update();
												SettingOnCheckHumiAMB->Update();
												SettingOnCheckHumiTGT->Update();
												SettingOnCheckLamp->Update();
												SettingOnCheckDO1->Update();
												SettingOnCheckDO2->Update();
												SettingOnCheckDO3->Update();
												SettingOnCheckDO4->Update();
												SettingOnCheckDO5->Update();

												SettingOnCheckTempAMB->Render();
												SettingOnCheckTempTGT->Render();
												SettingOnCheckHumiAMB->Render();
												SettingOnCheckHumiTGT->Render();
												SettingOnCheckLamp->Render();
												SettingOnCheckDO1->Render();
												SettingOnCheckDO2->Render();
												SettingOnCheckDO3->Render();
												SettingOnCheckDO4->Render();
												SettingOnCheckDO5->Render();

												for (int date = 0; date < 3; date++)
												{
													Textpos.x = 137 + date * 100;
													Textpos.y = 875;
													Textend.x = 236 + date * 100;
													Textend.y = 939;
													wstring text = to_wstring(search.StartDate[date]);
													RECT rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

													DirectWrite::Get()->RenderText(text, rect);

													Textpos.x = 563 + date * 100;
													Textend.x = 662 + date * 100;
													text = to_wstring(search.EndDate[date]);
													rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

													DirectWrite::Get()->RenderText(text, rect);
												}

												Loading[id % 3]->Update();
												Loading[id % 3]->Render();
												id++;
											}
										}
									}
								}
							}
						}
					}
				}

				for (int i = search.StartDate[0]; i <= search.EndDate[0]; i++)
				{
					if (search.EndDate[0] > search.StartDate[0])
					{
						for (int j = search.StartDate[1]; j <= search.EndDate[1] + 12; j++)
						{
							if (search.EndDate[1] > search.StartDate[1])
							{
								for (int k = search.StartDate[2]; k <= search.EndDate[2] + (lastDay(search.StartDate[0], search.StartDate[1]) + 1 - search.StartDate[2]); k++)
								{
									int id = 1;
									while (true)
									{
										if (!DataBase->DBLoad(search.Data, id, MAIN_DATA, i, j, k))
										{
											break;
										}
										else
										{
											SettingOnCheckTempAMB->Update();
											SettingOnCheckTempTGT->Update();
											SettingOnCheckHumiAMB->Update();
											SettingOnCheckHumiTGT->Update();
											SettingOnCheckLamp->Update();
											SettingOnCheckDO1->Update();
											SettingOnCheckDO2->Update();
											SettingOnCheckDO3->Update();
											SettingOnCheckDO4->Update();
											SettingOnCheckDO5->Update();

											SettingOnCheckTempAMB->Render();
											SettingOnCheckTempTGT->Render();
											SettingOnCheckHumiAMB->Render();
											SettingOnCheckHumiTGT->Render();
											SettingOnCheckLamp->Render();
											SettingOnCheckDO1->Render();
											SettingOnCheckDO2->Render();
											SettingOnCheckDO3->Render();
											SettingOnCheckDO4->Render();
											SettingOnCheckDO5->Render();

											for (int date = 0; date < 3; date++)
											{
												Textpos.x = 137 + date * 100;
												Textpos.y = 875;
												Textend.x = 236 + date * 100;
												Textend.y = 939;
												wstring text = to_wstring(search.StartDate[date]);
												RECT rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

												DirectWrite::Get()->RenderText(text, rect);

												Textpos.x = 563 + date * 100;
												Textend.x = 662 + date * 100;
												text = to_wstring(search.EndDate[date]);
												rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

												DirectWrite::Get()->RenderText(text, rect);
											}

											Loading[id % 3]->Update();
											Loading[id % 3]->Render();
											id++;
										}
									}
								}
							}
							else
							{
								for (int k = search.StartDate[2]; k <= search.EndDate[2]; k++)
								{
									int id = 1;
									while (true)
									{
										if (!DataBase->DBLoad(search.Data, id, MAIN_DATA, i, j, k))
										{
											break;
										}
										else
										{
											SettingOnCheckTempAMB->Update();
											SettingOnCheckTempTGT->Update();
											SettingOnCheckHumiAMB->Update();
											SettingOnCheckHumiTGT->Update();
											SettingOnCheckLamp->Update();
											SettingOnCheckDO1->Update();
											SettingOnCheckDO2->Update();
											SettingOnCheckDO3->Update();
											SettingOnCheckDO4->Update();
											SettingOnCheckDO5->Update();

											SettingOnCheckTempAMB->Render();
											SettingOnCheckTempTGT->Render();
											SettingOnCheckHumiAMB->Render();
											SettingOnCheckHumiTGT->Render();
											SettingOnCheckLamp->Render();
											SettingOnCheckDO1->Render();
											SettingOnCheckDO2->Render();
											SettingOnCheckDO3->Render();
											SettingOnCheckDO4->Render();
											SettingOnCheckDO5->Render();

											for (int date = 0; date < 3; date++)
											{
												Textpos.x = 137 + date * 100;
												Textpos.y = 875;
												Textend.x = 236 + date * 100;
												Textend.y = 939;
												wstring text = to_wstring(search.StartDate[date]);
												RECT rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

												DirectWrite::Get()->RenderText(text, rect);

												Textpos.x = 563 + date * 100;
												Textend.x = 662 + date * 100;
												text = to_wstring(search.EndDate[date]);
												rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

												DirectWrite::Get()->RenderText(text, rect);
											}

											Loading[id % 3]->Update();
											Loading[id % 3]->Render();
											id++;
										}
									}
								}
							}
						}
					}
					else
					{
						for (int j = search.StartDate[1]; j <= search.EndDate[1]; j++)
						{
							for (int k = search.StartDate[2]; k <= search.EndDate[2]; k++)
							{
								int id = 1;
								while (true)
								{
									if (!DataBase->DBLoad(search.Data, id, MAIN_DATA, i, j, k))
									{
										break;
									}
									else
									{
										SettingOnCheckTempAMB->Update();
										SettingOnCheckTempTGT->Update();
										SettingOnCheckHumiAMB->Update();
										SettingOnCheckHumiTGT->Update();
										SettingOnCheckLamp->Update();
										SettingOnCheckDO1->Update();
										SettingOnCheckDO2->Update();
										SettingOnCheckDO3->Update();
										SettingOnCheckDO4->Update();
										SettingOnCheckDO5->Update();

										SettingOnCheckTempAMB->Render();
										SettingOnCheckTempTGT->Render();
										SettingOnCheckHumiAMB->Render();
										SettingOnCheckHumiTGT->Render();
										SettingOnCheckLamp->Render();
										SettingOnCheckDO1->Render();
										SettingOnCheckDO2->Render();
										SettingOnCheckDO3->Render();
										SettingOnCheckDO4->Render();
										SettingOnCheckDO5->Render();

										for (int date = 0; date < 3; date++)
										{
											Textpos.x = 137 + date * 100;
											Textpos.y = 875;
											Textend.x = 236 + date * 100;
											Textend.y = 939;
											wstring text = to_wstring(search.StartDate[date]);
											RECT rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

											DirectWrite::Get()->RenderText(text, rect);

											Textpos.x = 563 + date * 100;
											Textend.x = 662 + date * 100;
											text = to_wstring(search.EndDate[date]);
											rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

											DirectWrite::Get()->RenderText(text, rect);
										}
										Loading[id % 3]->Update();
										Loading[id % 3]->Render();
										id++;
									}
								}
							}
						}
					}
				}
			}
			//엑셀 세이브
			if (RangeCheck(mousePos.x, 1518, 1655) && RangeCheck(mousePos.y, 828, 873))
			{
				DataBase->DBExport(search.Data, search.StartDate[0], search.StartDate[1], search.StartDate[2], search.EndDate[0], search.EndDate[1], search.EndDate[2]);
			}
			//사진 세이브
			if (RangeCheck(mousePos.x, 1691, 1828) && RangeCheck(mousePos.y, 828, 873))
			{
				try
				{
					imwrite(FileDiaLog::RenameSaveImage(), graph.exportGraph);
				}
				catch (const std::exception&)
				{
					return;
				}
			}
			//그래프 온오프
			if (RangeCheck(mousePos.x, 1300, 1320))
			{
				for (int i = 0; i < 5; i++)
				{
					if (RangeCheck(mousePos.y, 874 + i * 34, 894 + i * 34))
					{
						if (search.DO[i] == true)
							search.DO[i] = false;
						else
							search.DO[i] = true;
						search.refreshGraph = true;
						break;
					}
				}
			}
			if (RangeCheck(mousePos.x, 1155, 1175))
			{
				for (int i = 0; i < 5; i++)
				{
					if (RangeCheck(mousePos.y, 874 + i * 34, 894 + i * 34))
					{
						if (i == 0)
						{
							if (search.AmbTemp == true)
								search.AmbTemp = false;
							else
								search.AmbTemp = true;
							search.refreshGraph = true;
							break;
						}
						if (i == 1)
						{
							if (search.TarTemp == true)
								search.TarTemp = false;
							else
								search.TarTemp = true;
							search.refreshGraph = true;
							break;
						}
						if (i == 2)
						{
							if (search.AmbHumi == true)
								search.AmbHumi = false;
							else
								search.AmbHumi = true;
							search.refreshGraph = true;
							break;
						}
						if (i == 3)
						{
							if (search.TarHumi == true)
								search.TarHumi = false;
							else
								search.TarHumi = true;
							search.refreshGraph = true;
							break;
						}
						if (i == 4)
						{
							if (search.LampPre == true)
								search.LampPre = false;
							else
								search.LampPre = true;
							search.refreshGraph = true;
							break;
						}
					}
				}
			}
		}

		Search->Update();
		if (search.EndDate[0] < search.StartDate[0])
			search.EndDate[0] = search.StartDate[0];
		else if (search.EndDate[0] == search.StartDate[0])
		{
			if (search.EndDate[1] < search.StartDate[1])
				search.EndDate[1] = search.StartDate[1];
			else if (search.EndDate[1] == search.StartDate[1])
			{
				if (search.EndDate[2] < search.StartDate[2])
					search.EndDate[2] = search.StartDate[2];
			}
		}

		if (search.Calender[0] == true)
		{
			StartCalenderPopup->Update();
		}
		if (search.Calender[1] == true)
		{
			EndCalenderPopup->Update();
		}
		SettingOnCheckTempAMB->Update();
		SettingOnCheckTempTGT->Update();
		SettingOnCheckHumiAMB->Update();
		SettingOnCheckHumiTGT->Update();
		SettingOnCheckLamp->Update();
		SettingOnCheckDO1->Update();
		SettingOnCheckDO2->Update();
		SettingOnCheckDO3->Update();
		SettingOnCheckDO4->Update();
		SettingOnCheckDO5->Update();
	}
	else if (index == 3)
	{
		if (mouseClick)
		{
			isKeyInput = false;
			for (int i = 0; i < 88; i++)
			{
				setting.ClickPos[i] = false;
			}
			if (RangeCheck(mousePos.x, 1656, 1791) && RangeCheck(mousePos.y, 961, 1002))
			{
				string settingPath = "image/Resources/setting.txt";;
				//settingPath += "setting.txt";
				ofstream ofs;
				ofs.open(settingPath);
				string SettingData = "";
				int index_Data = 0;
				for (index_Data = 0; index_Data < 33; index_Data++)
				{
					std::cout << index_Data << std::endl;
					if (index_Data == 0)
						SettingData += setting.DataLocation;
					else if (index_Data == 1)
						SettingData += to_string(setting.Password);
					else if (index_Data == 2)
						SettingData += to_string(setting.SaveDataInterval);
					else if (index_Data == 3)
						SettingData += to_string(setting.ComPort[index_Data - 3]);
					else if (index_Data == 4)
						SettingData += to_string(setting.ComPort[index_Data - 3]);
					else if (index_Data == 5)
						SettingData += to_string(setting.ComPort[index_Data - 3]);
					else if (index_Data == 6)
						SettingData += to_string(setting.ComPort[index_Data - 3]);
					else if (index_Data == 7)
						SettingData += to_string(setting.ComPort[index_Data - 3]);
					else if (index_Data == 8)
						SettingData += to_string(setting.ComPort[index_Data - 3]);
					else if (index_Data == 9)
						SettingData += setting.DIPre[index_Data - 9];
					else if (index_Data == 10)
						SettingData += setting.DIPre[index_Data - 9];
					else if (index_Data == 11)
						SettingData += setting.DIPre[index_Data - 9];
					else if (index_Data == 12)
						SettingData += setting.DIPre[index_Data - 9];
					else if (index_Data == 13)
						SettingData += setting.DIPre[index_Data - 9];
					else if (index_Data == 14)
						SettingData += setting.DIPre[index_Data - 9];
					else if (index_Data == 15)
						SettingData += setting.DIPre[index_Data - 9];
					else if (index_Data == 16)
						SettingData += setting.DIPre[index_Data - 9];
					else if (index_Data == 17)
						SettingData += setting.Alarm[index_Data - 17];
					else if (index_Data == 18)
						SettingData += setting.Alarm[index_Data - 17];
					else if (index_Data == 19)
						SettingData += setting.Alarm[index_Data - 17];
					else if (index_Data == 20)
						SettingData += setting.Alarm[index_Data - 17];
					else if (index_Data == 21)
						SettingData += setting.Alarm[index_Data - 17];
					else if (index_Data == 22)
						SettingData += setting.Alarm[index_Data - 17];
					else if (index_Data == 23)
						SettingData += setting.Alarm[index_Data - 17];
					else if (index_Data == 24)
						SettingData += setting.Alarm[index_Data - 17];
					else if (index_Data == 25)
						SettingData += setting.Alarm[index_Data - 17];
					else if (index_Data == 26)
						SettingData += setting.Alarm[index_Data - 17];
					else if (index_Data == 27)
						SettingData += setting.Alarm[index_Data - 17];
					else if (index_Data == 28)
						SettingData += setting.Alarm[index_Data - 17];
					else if (index_Data == 29)
						SettingData += setting.Alarm[index_Data - 17];
					else if (index_Data == 30)
						SettingData += setting.Alarm[index_Data - 17];
					else if (index_Data == 31)
						SettingData += setting.Alarm[index_Data - 17];
					else if (index_Data == 32)
						SettingData += setting.Alarm[index_Data - 17];
					if (index_Data < 32)
						SettingData += "\n";
				}

				std::cout << "Complete" << std::endl;
				if (SettingData.empty() == false)
					ofs.write(SettingData.c_str(), SettingData.size());
				ofs.close();
				std::cout << "Closed Setting Data" << std::endl;

				for (int i = 1; i < 11; i++)
				{
					sSaveData.SaveTempData.Table = LAMP_PRESET;
					if (i == 1)
						DataBase->DBDel(LAMP_PRESET, i);
					sSaveData.SaveTempData.presLP.PRES_NO = i;
					sSaveData.SaveTempData.presLP.WATTS = setting.LampPre[i - 1][0];//lampPresWATTS[lampPresNo - 1];
					sSaveData.SaveTempData.presLP.LAMP1 = setting.LampPre[i - 1][1];
					sSaveData.SaveTempData.presLP.LAMP2 = setting.LampPre[i - 1][2];
					sSaveData.SaveTempData.presLP.LAMP3 = setting.LampPre[i - 1][3];
					sSaveData.SaveTempData.presLP.LAMP4 = setting.LampPre[i - 1][4];
					sSaveData.SettingSaveData.push_back(sSaveData.SaveTempData);
				}
				for (int i = 1; i < 6; i++)
				{
					sSaveData.SaveTempData.Table = DO_PRESET;
					sSaveData.SaveTempData.presDO.DO_NO = i;
					sSaveData.SaveTempData.presDO.DO_NAME = setting.DOPre[i - 1];
					sSaveData.SaveTempData.presDO.DO_RELAY = 0;
					sSaveData.SettingSaveData.push_back(sSaveData.SaveTempData);
					if (i == 1)
						DataBase->DBDel(DO_PRESET, i);
				}
				DataBase->DBSave(sSaveData.SettingSaveData);
			}
			if (RangeCheck(mousePos.x, 150, 518) && RangeCheck(mousePos.y, 185, 227))
			{
				isKeyInput = true;
				KeyCase = BASICKEY;
				setting.ClickPos[63] = true;
			}
			if (RangeCheck(mousePos.x, 557, 730) && RangeCheck(mousePos.y, 185, 227))
			{
				isKeyInput = true;
				KeyCase = NUMKEY;
				setting.ClickPos[0] = true;
			}
			if (RangeCheck(mousePos.x, 327, 461) && RangeCheck(mousePos.y, 244, 286))
			{
				isKeyInput = true;
				KeyCase = NUMKEY;
				setting.ClickPos[1] = true;
			}
			if (RangeCheck(mousePos.x, 261, 513))
			{
				if (RangeCheck(mousePos.y, 361, 403))
				{
					isKeyInput = true;
					KeyCase = NUMKEY;
					setting.ClickPos[2] = true;
				}
				if (RangeCheck(mousePos.y, 408, 450))
				{
					isKeyInput = true;
					KeyCase = NUMKEY;
					setting.ClickPos[3] = true;
				}
				if (RangeCheck(mousePos.y, 455, 497))
				{
					isKeyInput = true;
					KeyCase = NUMKEY;
					setting.ClickPos[4] = true;
				}
				if (RangeCheck(mousePos.y, 502, 544))
				{
					isKeyInput = true;
					KeyCase = NUMKEY;
					setting.ClickPos[5] = true;
				}
				if (RangeCheck(mousePos.y, 549, 591))
				{
					isKeyInput = true;
					KeyCase = NUMKEY;
					setting.ClickPos[6] = true;
				}
				if (RangeCheck(mousePos.y, 596, 638))
				{
					isKeyInput = true;
					KeyCase = NUMKEY;
					setting.ClickPos[7] = true;
				}
				if (RangeCheck(mousePos.y, 716, 758))
				{
					isKeyInput = true;
					KeyCase = BASICKEY;
					setting.ClickPos[8] = true;
				}
				if (RangeCheck(mousePos.y, 763, 805))
				{
					isKeyInput = true;
					KeyCase = BASICKEY;
					setting.ClickPos[9] = true;
				}
				if (RangeCheck(mousePos.y, 810, 852))
				{
					isKeyInput = true;
					KeyCase = BASICKEY;
					setting.ClickPos[10] = true;
				}
				if (RangeCheck(mousePos.y, 857, 899))
				{
					isKeyInput = true;
					KeyCase = BASICKEY;
					setting.ClickPos[11] = true;
				}
				if (RangeCheck(mousePos.y, 904, 946))
				{
					isKeyInput = true;
					KeyCase = BASICKEY;
					setting.ClickPos[12] = true;
				}
			}
			if (RangeCheck(mousePos.x, 850, 1267) && RangeCheck(mousePos.y, 222, 561))
			{
				isKeyInput = true;
				KeyCase = NUMKEY;
				if (RangeCheck(mousePos.x, 850, 946))
				{
					if (RangeCheck(mousePos.y, 222, 254))
						setting.ClickPos[13] = true;
					else if (RangeCheck(mousePos.y, 257, 288))
						setting.ClickPos[18] = true;
					else if (RangeCheck(mousePos.y, 291, 322))
						setting.ClickPos[23] = true;
					else if (RangeCheck(mousePos.y, 325, 356))
						setting.ClickPos[28] = true;
					else if (RangeCheck(mousePos.y, 359, 391))
						setting.ClickPos[33] = true;
					else if (RangeCheck(mousePos.y, 393, 425))
						setting.ClickPos[38] = true;
					else if (RangeCheck(mousePos.y, 428, 459))
						setting.ClickPos[43] = true;
					else if (RangeCheck(mousePos.y, 462, 493))
						setting.ClickPos[48] = true;
					else if (RangeCheck(mousePos.y, 496, 528))
						setting.ClickPos[53] = true;
					else if (RangeCheck(mousePos.y, 530, 561))
						setting.ClickPos[58] = true;
				}
				else if (RangeCheck(mousePos.x, 948, 1026))
				{
					if (RangeCheck(mousePos.y, 222, 254))
						setting.ClickPos[14] = true;
					else if (RangeCheck(mousePos.y, 257, 288))
						setting.ClickPos[19] = true;
					else if (RangeCheck(mousePos.y, 291, 322))
						setting.ClickPos[24] = true;
					else if (RangeCheck(mousePos.y, 325, 356))
						setting.ClickPos[29] = true;
					else if (RangeCheck(mousePos.y, 359, 391))
						setting.ClickPos[34] = true;
					else if (RangeCheck(mousePos.y, 393, 425))
						setting.ClickPos[39] = true;
					else if (RangeCheck(mousePos.y, 428, 459))
						setting.ClickPos[44] = true;
					else if (RangeCheck(mousePos.y, 462, 493))
						setting.ClickPos[49] = true;
					else if (RangeCheck(mousePos.y, 496, 528))
						setting.ClickPos[54] = true;
					else if (RangeCheck(mousePos.y, 530, 561))
						setting.ClickPos[59] = true;
				}
				else if (RangeCheck(mousePos.x, 1029, 1107))
				{
					if (RangeCheck(mousePos.y, 222, 254))
						setting.ClickPos[15] = true;
					else if (RangeCheck(mousePos.y, 257, 288))
						setting.ClickPos[20] = true;
					else if (RangeCheck(mousePos.y, 291, 322))
						setting.ClickPos[25] = true;
					else if (RangeCheck(mousePos.y, 325, 356))
						setting.ClickPos[30] = true;
					else if (RangeCheck(mousePos.y, 359, 391))
						setting.ClickPos[35] = true;
					else if (RangeCheck(mousePos.y, 393, 425))
						setting.ClickPos[40] = true;
					else if (RangeCheck(mousePos.y, 428, 459))
						setting.ClickPos[45] = true;
					else if (RangeCheck(mousePos.y, 462, 493))
						setting.ClickPos[50] = true;
					else if (RangeCheck(mousePos.y, 496, 528))
						setting.ClickPos[55] = true;
					else if (RangeCheck(mousePos.y, 530, 561))
						setting.ClickPos[60] = true;
				}
				else if (RangeCheck(mousePos.x, 1109, 1187))
				{
					if (RangeCheck(mousePos.y, 222, 254))
						setting.ClickPos[16] = true;
					else if (RangeCheck(mousePos.y, 257, 288))
						setting.ClickPos[21] = true;
					else if (RangeCheck(mousePos.y, 291, 322))
						setting.ClickPos[26] = true;
					else if (RangeCheck(mousePos.y, 325, 356))
						setting.ClickPos[31] = true;
					else if (RangeCheck(mousePos.y, 359, 391))
						setting.ClickPos[36] = true;
					else if (RangeCheck(mousePos.y, 393, 425))
						setting.ClickPos[41] = true;
					else if (RangeCheck(mousePos.y, 428, 459))
						setting.ClickPos[46] = true;
					else if (RangeCheck(mousePos.y, 462, 493))
						setting.ClickPos[51] = true;
					else if (RangeCheck(mousePos.y, 496, 528))
						setting.ClickPos[56] = true;
					else if (RangeCheck(mousePos.y, 530, 561))
						setting.ClickPos[61] = true;
				}
				else if (RangeCheck(mousePos.x, 1189, 1267))
				{
					if (RangeCheck(mousePos.y, 222, 254))
						setting.ClickPos[17] = true;
					else if (RangeCheck(mousePos.y, 257, 288))
						setting.ClickPos[22] = true;
					else if (RangeCheck(mousePos.y, 291, 322))
						setting.ClickPos[27] = true;
					else if (RangeCheck(mousePos.y, 325, 356))
						setting.ClickPos[32] = true;
					else if (RangeCheck(mousePos.y, 359, 391))
						setting.ClickPos[37] = true;
					else if (RangeCheck(mousePos.y, 393, 425))
						setting.ClickPos[42] = true;
					else if (RangeCheck(mousePos.y, 428, 459))
						setting.ClickPos[47] = true;
					else if (RangeCheck(mousePos.y, 462, 493))
						setting.ClickPos[52] = true;
					else if (RangeCheck(mousePos.y, 496, 528))
						setting.ClickPos[57] = true;
					else if (RangeCheck(mousePos.y, 530, 561))
						setting.ClickPos[62] = true;
				}
			}
			if (RangeCheck(mousePos.x, 925, 1177))
			{
				isKeyInput = true;
				KeyCase = BASICKEY;
				if (RangeCheck(mousePos.y, 603, 645))
					setting.ClickPos[64] = true;
				else if (RangeCheck(mousePos.y, 650, 692))
					setting.ClickPos[65] = true;
				else if (RangeCheck(mousePos.y, 697, 739))
					setting.ClickPos[66] = true;
				else if (RangeCheck(mousePos.y, 744, 786))
					setting.ClickPos[67] = true;
				else if (RangeCheck(mousePos.y, 791, 833))
					setting.ClickPos[68] = true;
				else if (RangeCheck(mousePos.y, 838, 880))
					setting.ClickPos[69] = true;
				else if (RangeCheck(mousePos.y, 885, 927))
					setting.ClickPos[70] = true;
				else if (RangeCheck(mousePos.y, 932, 974))
					setting.ClickPos[71] = true;
			}
			if (RangeCheck(mousePos.x, 1481, 1733) && RangeCheck(mousePos.y, 190, 937))
			{
				isKeyInput = true;
				KeyCase = BASICKEY;
				if (RangeCheck(mousePos.y, 190, 232))
					setting.ClickPos[72] = true;
				else if (RangeCheck(mousePos.y, 237, 279))
					setting.ClickPos[73] = true;
				else if (RangeCheck(mousePos.y, 284, 326))
					setting.ClickPos[74] = true;
				else if (RangeCheck(mousePos.y, 331, 373))
					setting.ClickPos[75] = true;
				else if (RangeCheck(mousePos.y, 378, 420))
					setting.ClickPos[76] = true;
				else if (RangeCheck(mousePos.y, 425, 467))
					setting.ClickPos[77] = true;
				else if (RangeCheck(mousePos.y, 472, 514))
					setting.ClickPos[78] = true;
				else if (RangeCheck(mousePos.y, 519, 561))
					setting.ClickPos[79] = true;
				else if (RangeCheck(mousePos.y, 566, 608))
					setting.ClickPos[80] = true;
				else if (RangeCheck(mousePos.y, 613, 655))
					setting.ClickPos[81] = true;
				else if (RangeCheck(mousePos.y, 660, 702))
					setting.ClickPos[82] = true;
				else if (RangeCheck(mousePos.y, 707, 749))
					setting.ClickPos[83] = true;
				else if (RangeCheck(mousePos.y, 754, 796))
					setting.ClickPos[84] = true;
				else if (RangeCheck(mousePos.y, 801, 843))
					setting.ClickPos[85] = true;
				else if (RangeCheck(mousePos.y, 848, 890))
					setting.ClickPos[86] = true;
				else if (RangeCheck(mousePos.y, 895, 937))
					setting.ClickPos[87] = true;
			}
			mouseClick = false;
		}
		Setting->Update();
	}
	if (index != 0) {
		if (RangeCheck(mousePos.x, 1810, 1844) && RangeCheck(mousePos.y, 14, 44))
		{
			index = 0;
		}
	}
	if (KeyDown(VK_RETURN) && isWarningPop == false)
	{
		if (vKeyboard.size() > 0)
		{
			if (vKeyboard.front() == "")
			{
				vKeyboard.clear();
				isKeyInput = false;
				return;
			}
		}
		switch (index)
		{
		case 0:
			if (KeyCase == PASSKEY)
			{
				if (vKeyboard.front() == to_string(setting.Password))
					PassSuccess = true;
				if (PassSuccess == false)
				{
					index = 0;
				}
				else
				{
					if (RangeCheck(mousePos.x, 1270, 1570) && RangeCheck(mousePos.y, 606, 795))
						system("shutdown -s");
					else if (RangeCheck(mousePos.x, 1270, 1570) && RangeCheck(mousePos.y, 260, 440))
						index = 3;
				}
				vKeyboard.erase(vKeyboard.begin());
			}
			break;
		case 1:
			if (KeyCase == NUMKEY)
			{
				for (int i = 0; i < 4; i++)
				{
					if (run.isClick[i])
					{
						if (i == 0)
						{
							run.TempTGT = stoi(vKeyboard.front());
							if (run.TempTGT > 120)
								run.TempTGT = 120;
							if (run.TempTGT < -20)
								run.TempTGT = -20;
							run.TempTGT *= 10;
							while (true)
							{
								if (MODBUS->send_datas(101, (uint16_t*)&run.TempTGT, 1))
									break;
								Sleep(80);
							}
						}
						if (i == 1)
						{
							run.HumiTGT = stoi(vKeyboard.front());
							if (run.HumiTGT < 0)
								run.HumiTGT = 0;
							if (run.HumiTGT > 95)
								run.HumiTGT = 95;
							run.HumiTGT *= 10;
							while (true)
							{
								if (MODBUS->send_datas(102, (uint16_t*)&run.HumiTGT, 1))
									break;
								Sleep(80);
							}
						}
						if (i == 2)
						{
							run.ProgramNum = stoi(vKeyboard.front());
							if (run.ProgramNum < 0)
								run.ProgramNum = 0;
							if (run.ProgramNum > recipe.FullIndex)
							{
								run.nonum = true;
							}
							else
							{
								run.FullTime = recipe.totalTime[run.ProgramNum];
								while (true)
								{
									Sleep(80);
									if (MODBUS->send_datas(99, (uint16_t*)&run.ProgramNum, 1))
										break;
								}
								if (DataBase->DBLoad(MainSendProgramData, run.ProgramNum, RECIPE_MAIN))
								{
									DataBase->DBLoad(MainSendProgramData, run.ProgramNum, RECIPE_REPT);

									run.ProgramName = MainSendProgramData.front().mainRC.RECIPE_NAME;
									MainSendProgramData.erase(MainSendProgramData.begin());
									run.StartStep = MainSendProgramData.front().reptRC.STEP_STRT;
									run.EndStep = MainSendProgramData.front().reptRC.STEP_END;
									run.EndCycle = MainSendProgramData.front().reptRC.REPT_CYC;
									MainSendProgramData.erase(MainSendProgramData.begin());

									for (int i = run.StartStep - 1; i < run.EndStep - 1; i++)
									{
										DataBase->DBLoad(MainSendProgramData, run.ProgramNum, RECIPE_CONTENTS, i + 1);
										recipe.Temp[run.ProgramNum][i] = MainSendProgramData.front().contRC.TEMP;
										recipe.Humi[run.ProgramNum][i] = MainSendProgramData.front().contRC.HUMID;
										recipe.Lamp[run.ProgramNum][i] = MainSendProgramData.front().contRC.LAMP_PRE;
										recipe.Time[run.ProgramNum][i] = MainSendProgramData.front().contRC.TIME_DUR;
										recipe.DO[run.ProgramNum][i] = 0;
										if (MainSendProgramData.front().contRC.DO1 > 0)
											recipe.DO[run.ProgramNum][i] = 1;
										if (MainSendProgramData.front().contRC.DO2 > 0)
											recipe.DO[run.ProgramNum][i] = 2;
										if (MainSendProgramData.front().contRC.DO3 > 0)
											recipe.DO[run.ProgramNum][i] = 3;
										if (MainSendProgramData.front().contRC.DO4 > 0)
											recipe.DO[run.ProgramNum][i] = 4;
										if (MainSendProgramData.front().contRC.DO5 > 0)
											recipe.DO[run.ProgramNum][i] = 5;
										MainSendProgramData.erase(MainSendProgramData.begin());
									}
								}
							}
						}
						if (i == 3)
						{
							run.LampPresetNum = stoi(vKeyboard.front());
						}
						vKeyboard.erase(vKeyboard.begin());
						run.isClick[i] = false;
						break;
					}
				}
			}
			break;
		case 2:
			if (KeyCase == NUMKEY)
			{
				for (int i = 0; i < 45; i++)
				{
					if (recipe.isSelIndex[recipe.SelIndex][i / 5][i % 5] == true)
					{
						switch (i)
						{
						case 0:
							recipe.Temp[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 1:
							recipe.Time[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 2:
							recipe.Humi[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 3:
							recipe.Lamp[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 4:
							recipe.DO[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 5:
							recipe.Temp[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 6:
							recipe.Time[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 7:
							recipe.Humi[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 8:
							recipe.Lamp[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 9:
							recipe.DO[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 10:
							recipe.Temp[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 11:
							recipe.Time[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 12:
							recipe.Humi[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 13:
							recipe.Lamp[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 14:
							recipe.DO[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 15:
							recipe.Temp[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 16:
							recipe.Time[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 17:
							recipe.Humi[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 18:
							recipe.Lamp[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 19:
							recipe.DO[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 20:
							recipe.Temp[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 21:
							recipe.Time[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 22:
							recipe.Humi[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 23:
							recipe.Lamp[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 24:
							recipe.DO[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 25:
							recipe.Temp[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 26:
							recipe.Time[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 27:
							recipe.Humi[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 28:
							recipe.Lamp[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 29:
							recipe.DO[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 30:
							recipe.Temp[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 31:
							recipe.Time[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 32:
							recipe.Humi[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 33:
							recipe.Lamp[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 34:
							recipe.DO[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 35:
							recipe.Temp[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 36:
							recipe.Time[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 37:
							recipe.Humi[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 38:
							recipe.Lamp[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 39:
							recipe.DO[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 40:
							recipe.Temp[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 41:
							recipe.Time[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 42:
							recipe.Humi[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 43:
							recipe.Lamp[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						case 44:
							recipe.DO[recipe.SelIndex][i / 5] = stoi(vKeyboard.front());
							break;
						default:
							break;
						}
						vKeyboard.erase(vKeyboard.begin());
						recipe.isSelIndex[recipe.SelIndex][i / 5][i % 5] = false;
						break;
					}
					if (i < 4)
					{
						if (recipe.NameStepCycle[recipe.SelIndex][i] == true)
						{
							if (i == 0)
							{
								recipe.Name[recipe.SelIndex] = vKeyboard.front();
							}
							else if (i == 1)
							{
								recipe.ReptStepF[recipe.SelIndex] = stoi(vKeyboard.front());
							}
							else if (i == 2)
							{
								recipe.ReptStepT[recipe.SelIndex] = stoi(vKeyboard.front());
							}
							else if (i == 3)
							{
								recipe.ReptStepC[recipe.SelIndex] = stoi(vKeyboard.front());
							}
							vKeyboard.erase(vKeyboard.begin());
							recipe.NameStepCycle[recipe.SelIndex][i] = false;
							break;
						}
					}
				}
			}
			if (KeyCase == BASICKEY)
			{
				recipe.Name[recipe.SelIndex] = vKeyboard.front();
				vKeyboard.erase(vKeyboard.begin());
				recipe.NameStepCycle[recipe.SelIndex][0] = false;
			}
			break;
		case 3:
			for (int i = 0; i < 88; i++)
			{
				if (setting.ClickPos[i] == true)
				{
					switch (i)
					{
					case 0:
						setting.Password = stoi(vKeyboard.front());
						break;
					case 1:
						setting.SaveDataInterval = stoi(vKeyboard.front());
						break;
					case 2:
						setting.ComPort[0] = stoi(vKeyboard.front());
						break;
					case 3:
						setting.ComPort[1] = stoi(vKeyboard.front());
						break;
					case 4:
						setting.ComPort[2] = stoi(vKeyboard.front());
						break;
					case 5:
						setting.ComPort[3] = stoi(vKeyboard.front());
						break;
					case 6:
						setting.ComPort[4] = stoi(vKeyboard.front());
						break;
					case 7:
						setting.ComPort[5] = stoi(vKeyboard.front());
						break;
					case 8:
						setting.DOPre[0] = vKeyboard.front();
						break;
					case 9:
						setting.DOPre[1] = vKeyboard.front();
						break;
					case 10:
						setting.DOPre[2] = vKeyboard.front();
						break;
					case 11:
						setting.DOPre[3] = vKeyboard.front();
						break;
					case 12:
						setting.DOPre[4] = vKeyboard.front();
						break;
					case 13:
						setting.LampPre[0][0] = stoi(vKeyboard.front());
						break;
					case 14:
						setting.LampPre[0][1] = stoi(vKeyboard.front());
						break;
					case 15:
						setting.LampPre[0][2] = stoi(vKeyboard.front());
						break;
					case 16:
						setting.LampPre[0][3] = stoi(vKeyboard.front());
						break;
					case 17:
						setting.LampPre[0][4] = stoi(vKeyboard.front());
						break;
					case 18:
						setting.LampPre[1][0] = stoi(vKeyboard.front());
						break;
					case 19:
						setting.LampPre[1][1] = stoi(vKeyboard.front());
						break;
					case 20:
						setting.LampPre[1][2] = stoi(vKeyboard.front());
						break;
					case 21:
						setting.LampPre[1][3] = stoi(vKeyboard.front());
						break;
					case 22:
						setting.LampPre[1][4] = stoi(vKeyboard.front());
						break;
					case 23:
						setting.LampPre[2][0] = stoi(vKeyboard.front());
						break;
					case 24:
						setting.LampPre[2][1] = stoi(vKeyboard.front());
						break;
					case 25:
						setting.LampPre[2][2] = stoi(vKeyboard.front());
						break;
					case 26:
						setting.LampPre[2][3] = stoi(vKeyboard.front());
						break;
					case 27:
						setting.LampPre[2][4] = stoi(vKeyboard.front());
						break;
					case 28:
						setting.LampPre[3][0] = stoi(vKeyboard.front());
						break;
					case 29:
						setting.LampPre[3][1] = stoi(vKeyboard.front());
						break;
					case 30:
						setting.LampPre[3][2] = stoi(vKeyboard.front());
						break;
					case 31:
						setting.LampPre[3][3] = stoi(vKeyboard.front());
						break;
					case 32:
						setting.LampPre[3][4] = stoi(vKeyboard.front());
						break;
					case 33:
						setting.LampPre[4][0] = stoi(vKeyboard.front());
						break;
					case 34:
						setting.LampPre[4][1] = stoi(vKeyboard.front());
						break;
					case 35:
						setting.LampPre[4][2] = stoi(vKeyboard.front());
						break;
					case 36:
						setting.LampPre[4][3] = stoi(vKeyboard.front());
						break;
					case 37:
						setting.LampPre[4][4] = stoi(vKeyboard.front());
						break;
					case 38:
						setting.LampPre[5][0] = stoi(vKeyboard.front());
						break;
					case 39:
						setting.LampPre[5][1] = stoi(vKeyboard.front());
						break;
					case 40:
						setting.LampPre[5][2] = stoi(vKeyboard.front());
						break;
					case 41:
						setting.LampPre[5][3] = stoi(vKeyboard.front());
						break;
					case 42:
						setting.LampPre[5][4] = stoi(vKeyboard.front());
						break;
					case 43:
						setting.LampPre[6][0] = stoi(vKeyboard.front());
						break;
					case 44:
						setting.LampPre[6][1] = stoi(vKeyboard.front());
						break;
					case 45:
						setting.LampPre[6][2] = stoi(vKeyboard.front());
						break;
					case 46:
						setting.LampPre[6][3] = stoi(vKeyboard.front());
						break;
					case 47:
						setting.LampPre[6][4] = stoi(vKeyboard.front());
						break;
					case 48:
						setting.LampPre[7][0] = stoi(vKeyboard.front());
						break;
					case 49:
						setting.LampPre[7][1] = stoi(vKeyboard.front());
						break;
					case 50:
						setting.LampPre[7][2] = stoi(vKeyboard.front());
						break;
					case 51:
						setting.LampPre[7][3] = stoi(vKeyboard.front());
						break;
					case 52:
						setting.LampPre[7][4] = stoi(vKeyboard.front());
						break;
					case 53:
						setting.LampPre[8][0] = stoi(vKeyboard.front());
						break;
					case 54:
						setting.LampPre[8][1] = stoi(vKeyboard.front());
						break;
					case 55:
						setting.LampPre[8][2] = stoi(vKeyboard.front());
						break;
					case 56:
						setting.LampPre[8][3] = stoi(vKeyboard.front());
						break;
					case 57:
						setting.LampPre[8][4] = stoi(vKeyboard.front());
						break;
					case 58:
						setting.LampPre[9][0] = stoi(vKeyboard.front());
						break;
					case 59:
						setting.LampPre[9][1] = stoi(vKeyboard.front());
						break;
					case 60:
						setting.LampPre[9][2] = stoi(vKeyboard.front());
						break;
					case 61:
						setting.LampPre[9][3] = stoi(vKeyboard.front());
						break;
					case 62:
						setting.LampPre[9][4] = stoi(vKeyboard.front());
						break;
					case 63:
						setting.DataLocation = vKeyboard.front();
						break;
					case 64:
						setting.DIPre[0] = vKeyboard.front();
						break;
					case 65:
						setting.DIPre[1] = vKeyboard.front();
						break;
					case 66:
						setting.DIPre[2] = vKeyboard.front();
						break;
					case 67:
						setting.DIPre[3] = vKeyboard.front();
						break;
					case 68:
						setting.DIPre[4] = vKeyboard.front();
						break;
					case 69:
						setting.DIPre[5] = vKeyboard.front();
						break;
					case 70:
						setting.DIPre[6] = vKeyboard.front();
						break;
					case 71:
						setting.DIPre[7] = vKeyboard.front();
						break;
					case 72:
						setting.Alarm[0] = vKeyboard.front();
						break;
					case 73:
						setting.Alarm[1] = vKeyboard.front();
						break;
					case 74:
						setting.Alarm[2] = vKeyboard.front();
						break;
					case 75:
						setting.Alarm[3] = vKeyboard.front();
						break;
					case 76:
						setting.Alarm[4] = vKeyboard.front();
						break;
					case 77:
						setting.Alarm[5] = vKeyboard.front();
						break;
					case 78:
						setting.Alarm[6] = vKeyboard.front();
						break;
					case 79:
						setting.Alarm[7] = vKeyboard.front();
						break;
					case 80:
						setting.Alarm[8] = vKeyboard.front();
						break;
					case 81:
						setting.Alarm[9] = vKeyboard.front();
						break;
					case 82:
						setting.Alarm[10] = vKeyboard.front();
						break;
					case 83:
						setting.Alarm[11] = vKeyboard.front();
						break;
					case 84:
						setting.Alarm[12] = vKeyboard.front();
						break;
					case 85:
						setting.Alarm[13] = vKeyboard.front();
						break;
					case 86:
						setting.Alarm[14] = vKeyboard.front();
						break;
					case 87:
						setting.Alarm[15] = vKeyboard.front();
						break;
					default:
						break;
					}
					setting.ClickPos[i] = false;
					vKeyboard.erase(vKeyboard.begin());
					break;
				}
			}
			break;
		default:
			break;
		}
		vKeyboard.clear();
		isKeyInput = false;
	}
	gIndex = index;
}

void SolarSystemScene::Render()
{	
	AdditiveBlendState->SetState();

	AlphaBlendState->SetState();
	if(index == 0)
		SelIndex->Render();
	else if (index == 1)
	{
		MainRun->Render();
		//현재온도
		Textpos.x = 95;
		Textpos.y = 122;
		Textend.x = 329;
		Textend.y = 248;
		wstring text = to_wstring(run.TempAMB * 0.1f);
		//text.assign(setting.DataLocation.begin(), setting.DataLocation.end());

		RECT rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

		DirectWrite::Get()->RenderText(text, rect);

		//설정온도
		Textpos.x = 382;
		Textpos.y = 122;
		Textend.x = 572;
		Textend.y = 248;
		text = to_wstring(run.TempTGT / 10);
		//text.assign(setting.DataLocation.begin(), setting.DataLocation.end());

		rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

		DirectWrite::Get()->RenderText(text, rect);

		//현재습도
		Textpos.x = 95;
		Textpos.y = 319;
		Textend.x = 329;
		Textend.y = 445;
		text = to_wstring(run.HumiAMB * 0.1f);
		//text.assign(setting.DataLocation.begin(), setting.DataLocation.end());

		rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

		DirectWrite::Get()->RenderText(text, rect);

		//설정습도
		Textpos.x = 382;
		Textpos.y = 319;
		Textend.x = 572;
		Textend.y = 445;
		text = to_wstring(run.HumiTGT / 10);
		//text.assign(setting.DataLocation.begin(), setting.DataLocation.end());

		rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

		DirectWrite::Get()->RenderText(text, rect);
		if (run.mode == Manual)
		{
			ManualBT->Render();
		}
		else
		{
			ProgramBT->Render();
			//프로그램 넘버
			Textpos.x = 952;
			Textpos.y = 88;
			Textend.x = 1054;
			Textend.y = 144;
			text = to_wstring(run.ProgramNum);
			//text.assign(setting.DataLocation.begin(), setting.DataLocation.end());

			rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

			DirectWrite::Get()->RenderText(text, rect);

			//프로그램 이름
			Textpos.x = 784;
			Textpos.y = 159;
			Textend.x = 1054;
			Textend.y = 201;
			//text = to_wstring(run.ProgramNum);
			text.assign(run.ProgramName.begin(), run.ProgramName.end());

			rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

			DirectWrite::Get()->RenderText(text, rect);

			//프로그램 시간 H
			Textpos.x = 784;
			Textpos.y = 206;
			Textend.x = 784 + (1054 - 784) / 2;
			Textend.y = 248;
			text = to_wstring(run.FullTime / 60);
			//text.assign(run.ProgramName.begin(), run.ProgramName.end());

			rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

			DirectWrite::Get()->RenderText(text, rect);

			//프로그램 시간 M
			Textpos.x = 784 + (1054 - 784) / 2;
			Textpos.y = 253;
			Textend.x = 1054;
			Textend.y = 248;
			text = to_wstring(run.FullTime % 60);
			//text.assign(run.ProgramName.begin(), run.ProgramName.end());

			rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

			DirectWrite::Get()->RenderText(text, rect);

			//남은 시간 H
			Textpos.x = 784;
			Textpos.y = 254;
			Textend.x = 784 + (1054 - 784) / 2;
			Textend.y = 296;
			text = to_wstring(run.RemainTime / 60);
			//text.assign(run.ProgramName.begin(), run.ProgramName.end());

			rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

			DirectWrite::Get()->RenderText(text, rect);

			//남은 시간 M
			Textpos.x = 784 + (1054 - 784) / 2;
			Textpos.y = 254;
			Textend.x = 1054;
			Textend.y = 296;
			text = to_wstring(run.RemainTime % 60);
			//text.assign(run.ProgramName.begin(), run.ProgramName.end());

			rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

			DirectWrite::Get()->RenderText(text, rect);

			//현재 스텝
			Textpos.x = 637;
			Textpos.y = 339;
			Textend.x = 683;
			Textend.y = 383;
			text = to_wstring(run.NowStep);
			//text.assign(run.ProgramName.begin(), run.ProgramName.end());

			rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

			DirectWrite::Get()->RenderText(text, rect);

			//최종 스텝
			Textpos.x = 725;
			Textpos.y = 339;
			Textend.x = 771;
			Textend.y = 383;
			text = to_wstring(run.EndStep);
			//text.assign(run.ProgramName.begin(), run.ProgramName.end());

			rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

			DirectWrite::Get()->RenderText(text, rect);

			//현재 사이클
			Textpos.x = 829;
			Textpos.y = 339;
			Textend.x = 911;
			Textend.y = 383;
			text = to_wstring(run.NowCycle);
			//text.assign(run.ProgramName.begin(), run.ProgramName.end());

			rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

			DirectWrite::Get()->RenderText(text, rect);

			//최종 사이클
			Textpos.x = 954;
			Textpos.y = 339;
			Textend.x = 1036;
			Textend.y = 383;
			text = to_wstring(run.EndCycle);
			//text.assign(run.ProgramName.begin(), run.ProgramName.end());

			rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

			DirectWrite::Get()->RenderText(text, rect);
		}
		if (run.isRun)
		{
			if (run.LampBT)
				LampBT->Render();
			for (int i = 0; i < 4; i++)
			{
				if (run.LampOn[i])
				{
					if (i == 0)
						LampLight1->Render();
					if (i == 1)
						LampLight2->Render();
					if (i == 2)
						LampLight3->Render();
					if (i == 3)
						LampLight4->Render();
				}
			}
			for (int i = 0; i < 5; i++)
			{
				if (run.DOBT[i])
				{
					if (i == 0)
						DOBT1->Render();
					if (i == 1)
						DOBT2->Render();
					if (i == 2)
						DOBT3->Render();
					if (i == 3)
						DOBT4->Render();
					if (i == 4)
						DOBT5->Render();
				}
			}

			DrawGraph();
		}
		else
		{
			RunBT->Render();
			StopBT->Render();
			run.sendNum = 0;
			maingraphdata.xMain.clear();
			maingraphdata.TemperatureNowGraphMain.clear();
			maingraphdata.HumidifyGraphNowMain.clear();
			maingraphdata.TemperatureSetGraphMain.clear();
			maingraphdata.HumidifyGraphSetMain.clear();
			maingraphdata.LampPresetGraphMain.clear();
			maingraphdata.DO1GraphMain.clear();
			maingraphdata.DO2GraphMain.clear();
			maingraphdata.DO3GraphMain.clear();
			maingraphdata.DO4GraphMain.clear();
			maingraphdata.DO5GraphMain.clear();
		}
		if (run.runQeustion == true)
		{
			doStartPopup->Update();
			doStartPopup->Render();
		}
		if (run.stopQeustion == true)
		{
			doStopPopup->Update();
			doStopPopup->Render();
		}
	}
	else if (index == 2)
	{
		RecipeLongIndex->Render();
		RecipeGreenLight->Render();
		for (int i = 0; i <= recipe.FullIndex; i++)
		{
			if (i - recipe.scroll >= 0)
			{
				Textpos.x = 93 + 22;
				Textpos.y = 169 + 2 + (i - recipe.scroll) * 38;
				Textend.x = 93 + 71;
				Textend.y = 169 + 35 + (i - recipe.scroll) * 38;
				//RecipeScrollFont->vDrawText(to_string(i + 1).c_str(), Textpos, Textend, 0, 0, 0, 1);
				wstring text = to_wstring((i + 1));
				//text.assign(setting.DataLocation.begin(), setting.DataLocation.end());

				RECT rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

				DirectWrite::Get()->RenderText(text, rect);

				Textpos.x = 93 + 85;
				Textpos.y = 169 + 2 + (i - recipe.scroll) * 38;
				Textend.x = 93 + 252;
				Textend.y = 169 + 35 + (i - recipe.scroll) * 38;
				//RecipeScrollFont->vDrawText(recipe.Name[i].c_str(), Textpos, Textend, 0, 0, 0);
				//text = to_wstring((i + 1));
				text.assign(recipe.Name[i].begin(), recipe.Name[i].end());

				rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

				DirectWrite::Get()->RenderText(text, rect);
			}
		}

		Recipe->Render();
		RecipeScrollBT->Render();

		Textpos.x = 545;
		Textpos.y = 81;
		Textend.x = 598;
		Textend.y = 114;
		wstring text = to_wstring(recipe.SelIndex + 1);
		//text.assign(recipe.Name[i].begin(), recipe.Name[i].end());

		RECT rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

		DirectWrite::Get()->RenderText(text, rect);

		Textpos.x = 290;
		Textpos.y = 513;
		Textend.x = 365;
		Textend.y = 552;
		text = to_wstring(recipe.ReptStepF[recipe.SelIndex]);
		rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

		DirectWrite::Get()->RenderText(text, rect);

		Textpos.x = 447;
		Textpos.y = 513;
		Textend.x = 522;
		Textend.y = 552;
		text = to_wstring(recipe.ReptStepT[recipe.SelIndex]);
		rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

		DirectWrite::Get()->RenderText(text, rect);

		Textpos.x = 668;
		Textpos.y = 513;
		Textend.x = 743;
		Textend.y = 552;
		text = to_wstring(recipe.ReptStepC[recipe.SelIndex]);
		rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

		DirectWrite::Get()->RenderText(text, rect);

		Textpos.x = 1011;
		Textpos.y = 513;
		Textend.x = 1086;
		Textend.y = 552;
		text = to_wstring(recipe.totalTime[recipe.SelIndex] / 60);
		rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

		DirectWrite::Get()->RenderText(text, rect);

		Textpos.x = 1168;
		Textpos.y = 513;
		Textend.x = 1243;
		Textend.y = 552;
		text = to_wstring(recipe.totalTime[recipe.SelIndex] % 60);
		rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

		DirectWrite::Get()->RenderText(text, rect);
		if (recipe.isFullStep[recipe.SelIndex] <= 7)
		{

		}
		if (recipe.isFullStep[recipe.SelIndex] == 8)
		{
			recipe8->Render();

		}
		if (recipe.isFullStep[recipe.SelIndex] == 9)
		{
			recipe9->Render();

		}
		for (int y = 0; y < 5; y++)
		{
			for (int x = 0; x < recipe.isFullStep[recipe.SelIndex]; x++)
			{
				Textpos.x = 629 + x * 86;
				Textend.x = 714 + x * 86;
				if (recipe.isFullStep[recipe.SelIndex] == 8)
				{
					Textpos.x = 629 + x * 75;
					Textend.x = 703 + x * 75;
				}
				if (recipe.isFullStep[recipe.SelIndex] == 9)
				{
					Textpos.x = 629 + x * 67;
					Textend.x = 695 + x * 67;
				}
				Textpos.y = 171 + y * 43;
				Textend.y = 213 + y * 43;
				if (y == 0) {
					text = to_wstring(recipe.Temp[recipe.SelIndex][x]);
					rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

					DirectWrite::Get()->RenderText(text, rect);
				}
				if (y == 1) {
					text = to_wstring(recipe.Time[recipe.SelIndex][x]);
					rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

					DirectWrite::Get()->RenderText(text, rect);
				}
				if (y == 2) {
					text = to_wstring(recipe.Humi[recipe.SelIndex][x]);
					rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

					DirectWrite::Get()->RenderText(text, rect);
				}
				if (y == 3) {
					text = to_wstring(recipe.Lamp[recipe.SelIndex][x]);
					rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

					DirectWrite::Get()->RenderText(text, rect);
				}
				if (y == 4) {
					text = to_wstring(recipe.DO[recipe.SelIndex][x]);
					rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

					DirectWrite::Get()->RenderText(text, rect);
				}
			}
		}
		if (recipe.Apply)
			DrawGraph();
	}
	else if (index == 4)
	{
		Search->Render();

		if (search.Calender[0] == true)
		{
			StartCalenderPopup->Render();
			search.SearchClick = false;

			Textpos.x = 133 + 87 + 30;
			Textpos.y = 597 + 15;
			Textend.x = 133 + 87 + 130;
			Textend.y = 597 + 15 + 37;

			string stringTemp = "";
			stringTemp += to_string(search.StartDate[0]);
			stringTemp += ": ";
			stringTemp += to_string(search.StartDate[1]);

			wstring text;// = to_wstring(setting.Alarm[run.Alarm]);
			text.assign(stringTemp.begin(), stringTemp.end());

			RECT rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

			DirectWrite::Get()->RenderText(text, rect);

			int startDay1 = 0;
			for (int i = 0; i < weekDay(search.StartDate[0], search.StartDate[1], 1); i++)
			{
				startDay1++;
			}
			int calenderY = 0;
			int calenderX = 1;
			for (int x_ = 1; x_ < lastDay(search.StartDate[0], search.StartDate[1]) + 1; x_++)
			{
				Textpos.x = 133 + 6 + 41 * (calenderX - 1) + 41 * startDay1 + 11;
				Textpos.y = 597 + 57 + 34 * calenderY;
				Textend.x = 133 + 48 + 41 * (calenderX - 1) + 41 * startDay1 + 11;
				Textend.y = 597 + 90 + 34 * calenderY;
				text = to_wstring(x_);
				//text.assign(stringTemp.begin(), stringTemp.end());

				RECT rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

				DirectWrite::Get()->RenderText(text, rect);
				//SearchCalenderDayFont->vDrawText(to_string(x_).c_str(), Textpos, Textend, 0, 0, 0, 1);
				if (weekDay(search.StartDate[0], search.StartDate[1], x_) == 6 && lastDay(search.StartDate[0], search.StartDate[1]) != x_)
				{
					calenderX = 0;
					calenderY++;
					startDay1 = 0;
				}
				calenderX++;
			}
		}
		if (search.Calender[1] == true)
		{
			EndCalenderPopup->Render();
			search.SearchClick = false;

			Textpos.x = 559 + 87 + 30;
			Textpos.y = 597 + 15;
			Textend.x = 559 + 87 + 130;
			Textend.y = 597 + 15 + 37;

			string stringTemp = "";
			stringTemp += to_string(search.EndDate[0]);
			stringTemp += ": ";
			stringTemp += to_string(search.EndDate[1]);

			wstring text;// = to_wstring(setting.Alarm[run.Alarm]);
			text.assign(stringTemp.begin(), stringTemp.end());

			RECT rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

			DirectWrite::Get()->RenderText(text, rect);

			int startDay1 = 0;
			for (int i = 0; i < weekDay(search.EndDate[0], search.EndDate[1], 1); i++)
			{
				startDay1++;
			}
			int calenderY = 0;
			int calenderX = 1;
			for (int x_ = 1; x_ < lastDay(search.EndDate[0], search.EndDate[1]) + 1; x_++)
			{
				Textpos.x = 559 + 6 + 41 * (calenderX - 1) + 41 * startDay1 + 11;
				Textpos.y = 597 + 57 + 34 * calenderY;
				Textend.x = 559 + 48 + 41 * (calenderX - 1) + 41 * startDay1 + 11;
				Textend.y = 597 + 90 + 34 * calenderY;
				text = to_wstring(x_);
				//text.assign(stringTemp.begin(), stringTemp.end());

				RECT rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

				DirectWrite::Get()->RenderText(text, rect);
				if (weekDay(search.EndDate[0], search.EndDate[1], x_) == 6 && lastDay(search.EndDate[0], search.EndDate[1]) != x_)
				{
					calenderX = 0;
					calenderY++;
					startDay1 = 0;
				}
				calenderX++;
			}
		}
		if (search.AmbTemp)
			SettingOnCheckTempAMB->Render();
		if (search.TarTemp)
			SettingOnCheckTempTGT->Render();
		if (search.AmbHumi)
			SettingOnCheckHumiAMB->Render();
		if (search.TarHumi)
			SettingOnCheckHumiTGT->Render();
		if (search.LampPre)
			SettingOnCheckLamp->Render();
		if (search.DO[0])
			SettingOnCheckDO1->Render();
		if (search.DO[1])
			SettingOnCheckDO2->Render();
		if (search.DO[2])
			SettingOnCheckDO3->Render();
		if (search.DO[3])
			SettingOnCheckDO4->Render();
		if (search.DO[4])
			SettingOnCheckDO5->Render();

		string stringTemp = "";
		stringTemp += to_string(search.StartDate[0]);
		stringTemp += ": ";
		stringTemp += to_string(search.StartDate[1]);
		stringTemp += ": ";
		stringTemp += to_string(search.StartDate[2]);
		Textpos.x = 187;
		Textend.x = 435;
		Textpos.y = 875;
		Textend.y = 939;

		wstring text;// = to_wstring(setting.Alarm[run.Alarm]);
		text.assign(stringTemp.begin(), stringTemp.end());

		RECT rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

		DirectWrite::Get()->RenderText(text, rect, 40.0F);

		stringTemp = "";
		stringTemp += to_string(search.EndDate[0]);
		stringTemp += ": ";
		stringTemp += to_string(search.EndDate[1]);
		stringTemp += ": ";
		stringTemp += to_string(search.EndDate[2]);
		Textpos.x = 613;
		Textend.x = 861;
		Textpos.y = 875;
		Textend.y = 939; 
		text.assign(stringTemp.begin(), stringTemp.end());

		rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

		DirectWrite::Get()->RenderText(text, rect, 40.0F);

		if (search.SearchClick || search.refreshGraph)
			DrawGraph();
	}
	else if (index == 3)
	{
		Setting->Render();

		Textpos.x = 180;
		Textpos.y = 188;
		Textend.x = 518;
		Textend.y = 227;
		wstring text;// = to_wstring(setting.Alarm[run.Alarm]);
		text.assign(setting.DataLocation.begin(), setting.DataLocation.end());

		RECT rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

		DirectWrite::Get()->RenderText(text, rect, 25.0F);
		//SettingPanelFont->vDrawText(setting.DataLocation.c_str(), Textpos, Textend, 0, 0, 0);

		Textpos.x = 587;
		Textpos.y = 188;
		Textend.x = 730;
		Textend.y = 227;
		text = to_wstring(setting.Password);
		//text.assign(setting.DataLocation.begin(), setting.DataLocation.end());

		rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

		DirectWrite::Get()->RenderText(text, rect, 25.0F);
		//SettingPanelFont->vDrawText(to_string(setting.Password).c_str(), Textpos, Textend, 0, 0, 0, 1);

		Textpos.x = 357;
		Textpos.y = 247;
		Textend.x = 461;
		Textend.y = 286;
		text = to_wstring(setting.SaveDataInterval);
		//text.assign(setting.DataLocation.begin(), setting.DataLocation.end());

		rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

		DirectWrite::Get()->RenderText(text, rect, 25.0F);
		//SettingPanelFont->vDrawText(to_string(setting.SaveDataInterval).c_str(), Textpos, Textend, 0, 0, 0, 1);

		for (int i = 0; i < 6; i++)
		{
			Textpos.x = 291;
			Textpos.y = 364 + i * 47;
			Textend.x = 513;
			Textend.y = 403 + i * 47;
			text = to_wstring(setting.ComPort[i]);
			//text.assign(setting.DataLocation.begin(), setting.DataLocation.end());

			rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

			DirectWrite::Get()->RenderText(text, rect, 25.0F);
			//SettingPanelFont->vDrawText(to_string(setting.ComPort[i]).c_str(), Textpos, Textend, 0, 0, 0, 1);
		}

		for (int i = 0; i < 5; i++)
		{
			Textpos.x = 291;
			Textpos.y = 719 + i * 47;
			Textend.x = 513;
			Textend.y = 758 + i * 47;
			text = L"";// to_wstring(setting.DOPre[i]);
			text.assign(setting.DOPre[i].begin(), setting.DOPre[i].end());

			rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

			DirectWrite::Get()->RenderText(text, rect, 25.0F);
			//SettingPanelFont->vDrawText((setting.DOPre[i]).c_str(), Textpos, Textend, 0, 0, 0, 1);
		}

		for (int i = 0; i < 8; i++)
		{
			Textpos.x = 955;
			Textpos.y = 606 + i * 47;
			Textend.x = 1177;
			Textend.y = 645 + i * 47;
			text = L"";// to_wstring(setting.DOPre[i]);
			text.assign(setting.DIPre[i].begin(), setting.DIPre[i].end());

			rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

			DirectWrite::Get()->RenderText(text, rect, 25.0F);
			//SettingPanelFont->vDrawText((setting.DIPre[i]).c_str(), Textpos, Textend, 0, 0, 0, 1);
		}

		for (int i = 0; i < 16; i++)
		{
			Textpos.x = 1511;
			Textpos.y = 193 + i * 47;
			Textend.x = 1733;
			Textend.y = 232 + i * 47;
			text = L"";// to_wstring(setting.DOPre[i]);
			text.assign(setting.Alarm[i].begin(), setting.Alarm[i].end());

			rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

			DirectWrite::Get()->RenderText(text, rect, 25.0F);
			//SettingPanelFont->vDrawText((setting.Alarm[i]).c_str(), Textpos, Textend, 0, 0, 0, 1);
		}

		for (int y = 0; y < 10; y++)
		{
			for (int x = 0; x < 5; x++)
			{
				if (x == 0)
				{
					Textpos.x = 850;
					Textpos.y = 222 + y * 34;
					Textend.x = 946;
					Textend.y = 254 + y * 34;
					text = to_wstring(setting.LampPre[y][x]);
					//text.assign(setting.Alarm[i].begin(), setting.Alarm[i].end());

					rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

					DirectWrite::Get()->RenderText(text, rect);
					//SettingPanelFont->vDrawText(to_string(setting.LampPre[y][x]).c_str(), Textpos, Textend, 0, 0, 0, 1);
				}
				else if (x == 1)
				{
					Textpos.x = 948;
					Textpos.y = 222 + y * 34;
					Textend.x = 1026;
					Textend.y = 254 + y * 34;
					text = to_wstring(setting.LampPre[y][x]);
					//text.assign(setting.Alarm[i].begin(), setting.Alarm[i].end());

					rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

					DirectWrite::Get()->RenderText(text, rect);
					//SettingPanelFont->vDrawText(to_string(setting.LampPre[y][x]).c_str(), Textpos, Textend, 0, 0, 0, 1);
				}
				else if (x == 2)
				{
					Textpos.x = 1029;
					Textpos.y = 222 + y * 34;
					Textend.x = 1107;
					Textend.y = 254 + y * 34;
					text = to_wstring(setting.LampPre[y][x]);
					//text.assign(setting.Alarm[i].begin(), setting.Alarm[i].end());

					rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

					DirectWrite::Get()->RenderText(text, rect);
					//SettingPanelFont->vDrawText(to_string(setting.LampPre[y][x]).c_str(), Textpos, Textend, 0, 0, 0, 1);
				}
				else if (x == 3)
				{
					Textpos.x = 1109;
					Textpos.y = 222 + y * 34;
					Textend.x = 1187;
					Textend.y = 254 + y * 34;
					text = to_wstring(setting.LampPre[y][x]);
					//text.assign(setting.Alarm[i].begin(), setting.Alarm[i].end());

					rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

					DirectWrite::Get()->RenderText(text, rect);
					//SettingPanelFont->vDrawText(to_string(setting.LampPre[y][x]).c_str(), Textpos, Textend, 0, 0, 0, 1);
				}
				else if (x == 4)
				{
					Textpos.x = 1189;
					Textpos.y = 222 + y * 34;
					Textend.x = 1267;
					Textend.y = 254 + y * 34;
					text = to_wstring(setting.LampPre[y][x]);
					//text.assign(setting.Alarm[i].begin(), setting.Alarm[i].end());

					rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

					DirectWrite::Get()->RenderText(text, rect);
					//SettingPanelFont->vDrawText(to_string(setting.LampPre[y][x]).c_str(), Textpos, Textend, 0, 0, 0, 1);
				}
			}
		}
	}
	//Sampler->SetState();
	if (isKeyInput)
	{
		if (KeyCase == PASSKEY && index == 0 && mousePos.y > 500)
		{
			if (run.isRun)
			{
				isRunPopup->SetWorldBuffer(3);
				isRunPopup->Update();
				isRunPopup->Render();
				isKeyInput = false;
			}
		}
		else
		{
			cv::Point DrawTextPos;// = mousePos;
			DrawTextPos.x = (int)mousePos.x + 188;
			DrawTextPos.y = WinHeight - ((int)mousePos.y) - 63;
			if (DrawTextPos.x > 1920 - 188)
				DrawTextPos.x = 1920 - 188;
			if (DrawTextPos.y < WinHeight - (1080 - 126))
				DrawTextPos.y = WinHeight - (1080 - 126);
			InputPop->pos.x = DrawTextPos.x;// , DrawTextPos.y);
			InputPop->pos.y = DrawTextPos.y;// , DrawTextPos.y);
			InputPop->Update();
			InputPop->Render();
			Textpos.x = DrawTextPos.x - 98;
			Textpos.y = WinHeight - (InputPop->pos.y) + 11;
			Textend.x = DrawTextPos.x + 370;
			Textend.y = WinHeight - (InputPop->pos.y) + 77;
			wstring text;// = to_wstring(setting.Alarm[run.Alarm]);
			text.assign(sKeyboard.begin(), sKeyboard.end());

			RECT rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

			DirectWrite::Get()->RenderText(text, rect, 30.0F);
		}
	}
	if (ModbusData.size() < 1)
	{
		isWarningPop = true;
		WarnPopup->Update();
		WarnPopup->Render();
	}
	else
	{
		if (run.Alarm > 0)
		{
			isWarningPop = true;
			AlarmPopup->Render();
			Textpos.x = 660 + 80;
			Textpos.y = 415 + 19;
			Textend.x = 660 + 519;
			Textend.y = 415 + 69;
			run.isRun = false;

			wstring text;// = to_wstring(setting.Alarm[run.Alarm]);
			text.assign(setting.Alarm[run.Alarm].begin(), setting.Alarm[run.Alarm].end());

			RECT rect = { Textpos.x, Textpos.y, Textend.x, Textend.y };

			DirectWrite::Get()->RenderText(text, rect);
		}
		else if (run.nonum == true)
		{
			isWarningPop = true;
			noNumPopup->Update();
			noNumPopup->Render();
			if (mouseClick)
			{
				run.nonum = false;
			}
		}
		else if (run.mode == Program)
		{
			if (run.RemainTime < 0)
			{
				ProgramEndPopup->Render();

			}
		}
		else
			isWarningPop = false;
	}
}

void SolarSystemScene::DrawGraph()
{
	D3D11_TEXTURE2D_DESC desc = { 0 };
	graph.texture->GetDesc(&desc);
	int textureType = cv::directx::getTypeFromDXGI_FORMAT(desc.Format);
	cv::Mat Temp(cv::Size(1920, 1080), CV_16UC4);
	cv::Mat graphClone;
	int srcType = Temp.type();
	try
	{
		cv::waitKey(1);
		switch (index)
		{
		case 1:
			graphClone = DrawGraphInOpenCV().clone();
			SetMatPos(graphClone, Temp, 515, 73);
			break;
		case 2:
			graphClone = DrawGraphInOpenCV(1).clone();
			SetMatPos(graphClone, Temp, 1390, 126);
			graphClone = DrawGraphInOpenCV(2).clone();
			SetMatPos(graphClone, Temp, 73, 626);
			break;
		case 4:
			if (search.Data.size() > 0)
			{
				graphClone = DrawGraphInOpenCV();
				//graphClone.convertTo(graphClone, CV_16UC4);
				//SetMatPos(graphClone, Temp, 125, 96);
			}
			break;
		default:
			break;
		}
		if (textureType == srcType)
		{
			int conversion[] = { 0, 0, 1, 1, 2, 2, -1, 3 };
			cv::Mat as4channelMat(graphClone.size(), CV_MAKE_TYPE(graphClone.depth(), 4));
			cv::mixChannels(&graphClone, 1, &as4channelMat, 1, conversion, 4);
			//cv::imwrite("A", graphClone);
			cv::cvtColor(graphClone, graphClone, cv::COLOR_BGR2BGRA);
			//cv::imshow("A", Temp);
			//cv::UMat u = Temp.getUMat();// .offset;
			//cout << Temp.getUMat(0).offset;
			graphClone.convertTo(graphClone, CV_16UC4);
			cv::directx::convertToD3D11Texture2D(graphClone, graph.texture);
		}
		else
		{

		}
		
	}
	catch (cv::Exception& e)
	{
		std::cerr << "ERROR: " << e.msg << std::endl;
	}
}
cv::Mat SolarSystemScene::DrawGraphInOpenCV(int recipeindex)
{
	if (index == 1)
	{//메인
		maingraphdata.xMain.push_back(run.sendNum);
		maingraphdata.TemperatureNowGraphMain.push_back(run.TempAMB);
		maingraphdata.HumidifyGraphNowMain.push_back(run.HumiAMB);
		maingraphdata.TemperatureSetGraphMain.push_back(run.TempTGT);
		maingraphdata.HumidifyGraphSetMain.push_back(run.HumiTGT);
		maingraphdata.LampPresetGraphMain.push_back(setting.LampPre[run.LampPresetNum][0] / 10);
		for (int i = 0; i < 5; i++)
		{
			if (run.DOBT[i])
			{
				if (i == 0)
					maingraphdata.DO1GraphMain.push_back(100);
				if (i == 1)
					maingraphdata.DO2GraphMain.push_back(100);
				if (i == 2)
					maingraphdata.DO3GraphMain.push_back(100);
				if (i == 3)
					maingraphdata.DO4GraphMain.push_back(100);
				if (i == 4)
					maingraphdata.DO5GraphMain.push_back(100);
			}
			else
			{
				if (i == 0)
					maingraphdata.DO1GraphMain.push_back(0);
				if (i == 1)
					maingraphdata.DO2GraphMain.push_back(0);
				if (i == 2)
					maingraphdata.DO3GraphMain.push_back(0);
				if (i == 3)
					maingraphdata.DO4GraphMain.push_back(0);
				if (i == 4)
					maingraphdata.DO5GraphMain.push_back(0);
			}
		}
		run.sendNum++;
		axesMainGraph = CvPlot::makePlotAxes();
		axesMainGraph.create<CvPlot::Series>(maingraphdata.xMain, maingraphdata.TemperatureNowGraphMain, "-r");
		axesMainGraph.create<CvPlot::Series>(maingraphdata.xMain, maingraphdata.HumidifyGraphNowMain, "-b");
		axesMainGraph.create<CvPlot::Series>(maingraphdata.xMain, maingraphdata.TemperatureSetGraphMain, "-s");
		axesMainGraph.create<CvPlot::Series>(maingraphdata.xMain, maingraphdata.HumidifyGraphSetMain, "-a");
		axesMainGraph.create<CvPlot::Series>(maingraphdata.xMain, maingraphdata.LampPresetGraphMain, "-y");
		axesMainGraph.create<CvPlot::Series>(maingraphdata.xMain, maingraphdata.DO1GraphMain, "-1");
		axesMainGraph.create<CvPlot::Series>(maingraphdata.xMain, maingraphdata.DO2GraphMain, "-2");
		axesMainGraph.create<CvPlot::Series>(maingraphdata.xMain, maingraphdata.DO3GraphMain, "-3");
		axesMainGraph.create<CvPlot::Series>(maingraphdata.xMain, maingraphdata.DO4GraphMain, "-4");
		axesMainGraph.create<CvPlot::Series>(maingraphdata.xMain, maingraphdata.DO5GraphMain, "-5");
		cv::Mat Graph = axesMainGraph.render(1042 - 515, 1841 - 73);
		return Graph;
	}
	if (index == 2)
	{//레시피
		int timeIndextemp = 0;
		cv::Mat RecipeSaveGraph(cv::Size(1825 - 1391, 461 - 127), CV_8UC3);
		if (recipeindex == 1)
		{
			int isFullStep = recipe.isFullStep[recipe.SelIndex];
			timeIndextemp = 1;
			std::vector<double> x(isFullStep + 1), TemperatureGraph(isFullStep + 1), HumidifyGraph(isFullStep + 1), LampPresetGraph(isFullStep + 1), DOGraph(isFullStep + 1);
			x[0] = 0;
			TemperatureGraph[0] = recipe.Time[recipe.SelIndex][0];
			HumidifyGraph[0] = recipe.Humi[recipe.SelIndex][0];
			LampPresetGraph[0] = setting.LampPre[recipe.Lamp[recipe.SelIndex][0] - 1][0] / 10;
			if (recipe.DO[recipe.SelIndex][0] > 0)
				DOGraph[0] = 100;
			else
				DOGraph[0] = 0;

			for (int step = 0; step < isFullStep; step++)
			{
				timeIndextemp += recipe.Time[recipe.SelIndex][step];
				x[step + 1] = timeIndextemp;
				TemperatureGraph[step + 1] = recipe.Temp[recipe.SelIndex][step];
				HumidifyGraph[step + 1] = recipe.Humi[recipe.SelIndex][step];
				int lampIndex = recipe.Lamp[recipe.SelIndex][step];
				LampPresetGraph[step + 1] = setting.LampPre[lampIndex - 1][0] / 10;
				if (recipe.DO[recipe.SelIndex][step] > 0)
					DOGraph[step + 1] = 100;
				else
					DOGraph[step + 1] = 0;
			}

			timeIndextemp = 0;
			CvPlot::Axes axesSmallGraph = CvPlot::makePlotAxes();
			axesSmallGraph.create<CvPlot::Series>(x, TemperatureGraph, "-r");
			axesSmallGraph.create<CvPlot::Series>(x, HumidifyGraph, "-b");
			axesSmallGraph.create<CvPlot::Series>(x, LampPresetGraph, "-y");
			axesSmallGraph.create<CvPlot::Series>(x, DOGraph, "-1");
			RecipeSaveGraph = axesSmallGraph.render(461 - 127, 1825 - 1391);
			return RecipeSaveGraph;
		}

		CvPlot::Axes axesTotalGraph = CvPlot::makePlotAxes();

		//Large
		if (recipeindex == 2)
		{
			if (recipe.ReptStepC[recipe.SelIndex] >= 1)
			{
				int vectorSize = recipe.ReptStepC[recipe.SelIndex] * (recipe.ReptStepT[recipe.SelIndex] - recipe.ReptStepF[recipe.SelIndex]) + (recipe.ReptStepF[recipe.SelIndex] + 1) + 2;
				std::vector<double> xLong(vectorSize), TemperatureGraphLong(vectorSize), HumidifyGraphLong(vectorSize),
					LampPresetGraphLong(vectorSize), DOGraphLong(vectorSize);
				xLong[0] = 0;
				TemperatureGraphLong[0] = recipe.Temp[recipe.SelIndex][0];
				HumidifyGraphLong[0] = recipe.Humi[recipe.SelIndex][0];
				LampPresetGraphLong[0] = setting.LampPre[recipe.Lamp[recipe.SelIndex][0] - 1][0] / 10;
				if (recipe.DO[recipe.SelIndex][0] > 0)
					DOGraphLong[0] = 100;
				else
					DOGraphLong[0] = 0;

				for (int step = 0; step < recipe.ReptStepF[recipe.SelIndex] - 1; step++)
				{
					timeIndextemp += recipe.Time[recipe.SelIndex][step];
					xLong[step + 1] = timeIndextemp;// * CV_2PI / xLong.size();
					TemperatureGraphLong[step + 1] = recipe.Temp[recipe.SelIndex][step];
					HumidifyGraphLong[step + 1] = recipe.Humi[recipe.SelIndex][step];
					int lampIndex = recipe.Lamp[recipe.SelIndex][step];
					LampPresetGraphLong[step + 1] = setting.LampPre[lampIndex - 1][0] / 10;
					if (recipe.DO[recipe.SelIndex][step] > 0)
						DOGraphLong[step + 1] = 100;
					else
						DOGraphLong[step + 1] = 0;
				}
				for (int cycle = 0; cycle < recipe.ReptStepC[recipe.SelIndex]; cycle++)
				{
					for (int step = recipe.ReptStepF[recipe.SelIndex] - 1; step < recipe.ReptStepT[recipe.SelIndex]; step++)
					{
						timeIndextemp += recipe.Time[recipe.SelIndex][step];

						xLong[(step)+(cycle * (recipe.ReptStepT[recipe.SelIndex] - recipe.ReptStepF[recipe.SelIndex])) + 1]
							= timeIndextemp;// * CV_2PI / xLong.size();
						TemperatureGraphLong[(step)+(cycle * (recipe.ReptStepT[recipe.SelIndex] - recipe.ReptStepF[recipe.SelIndex])) + 1]
							= recipe.Temp[recipe.SelIndex][step];
						HumidifyGraphLong[(step)+(cycle * (recipe.ReptStepT[recipe.SelIndex] - recipe.ReptStepF[recipe.SelIndex])) + 1]
							= recipe.Humi[recipe.SelIndex][step];
						int lampIndex = recipe.Lamp[recipe.SelIndex][step];
						LampPresetGraphLong[(step)+(cycle * (recipe.ReptStepT[recipe.SelIndex] - recipe.ReptStepF[recipe.SelIndex])) + 1]
							= setting.LampPre[lampIndex - 1][0] / 10;
						if (recipe.DO[recipe.SelIndex][step] > 0)
							DOGraphLong[(step)+(cycle * (recipe.ReptStepT[recipe.SelIndex] - recipe.ReptStepF[recipe.SelIndex])) + 1] = 100;
						else
							DOGraphLong[(step)+(cycle * (recipe.ReptStepT[recipe.SelIndex] - recipe.ReptStepF[recipe.SelIndex])) + 1] = 0;
					}
					if (cycle == recipe.ReptStepC[recipe.SelIndex] - 1)
					{
						xLong[vectorSize - 2] = (timeIndextemp);// * CV_2PI / xLong.size();
						TemperatureGraphLong[vectorSize - 2] = 25;
						HumidifyGraphLong[vectorSize - 2] = 0;
						LampPresetGraphLong[vectorSize - 2] = 0;
						DOGraphLong[vectorSize - 2] = 0;

						xLong[vectorSize - 1] = (timeIndextemp + 30);// * CV_2PI / xLong.size();
						TemperatureGraphLong[vectorSize - 1] = 25;
						HumidifyGraphLong[vectorSize - 1] = 0;
						LampPresetGraphLong[vectorSize - 1] = 0;
						DOGraphLong[vectorSize - 1] = 0;
					}
				}
				std::cout << "Graph X : " << timeIndextemp + 30 << std::endl << std::endl;
				recipe.totalTime[recipe.SelIndex] = timeIndextemp + 30;
				axesTotalGraph.create<CvPlot::Series>(xLong, TemperatureGraphLong, "-r");
				axesTotalGraph.create<CvPlot::Series>(xLong, HumidifyGraphLong, "-b");
				axesTotalGraph.create<CvPlot::Series>(xLong, LampPresetGraphLong, "-y");
				axesTotalGraph.create<CvPlot::Series>(xLong, DOGraphLong, "-1");

				xLong.clear();
				TemperatureGraphLong.clear();
				HumidifyGraphLong.clear();
				LampPresetGraphLong.clear();
				DOGraphLong.clear();
			}
			RecipeSaveGraph = axesTotalGraph.render(1042 - 626, 1841 - 73);
			return RecipeSaveGraph;
		}

	}
	if (index == 4)
	{//서치
		vector<Data> SearchGraphData;
		SearchGraphData.clear();
		for (int i = 0; i < search.Data.size(); i++)
		{
			if (SearchGraphData.size() < search.Data.size())
				SearchGraphData.push_back(search.Data.at(i));
		}
		vector<double> xPos(SearchGraphData.size());
		vector<double> TemperatureGraphNow(SearchGraphData.size());
		vector<double> TemperatureGraphSet(SearchGraphData.size());
		vector<double> HumidifyGraphNow(SearchGraphData.size());
		vector<double> HumidifyGraphSet(SearchGraphData.size());
		vector<double> LampPresetGraphNow(SearchGraphData.size());
		vector<double> DO1Graph(SearchGraphData.size());
		vector<double> DO2Graph(SearchGraphData.size());
		vector<double> DO3Graph(SearchGraphData.size());
		vector<double> DO4Graph(SearchGraphData.size());
		vector<double> DO5Graph(SearchGraphData.size());

		if (SearchGraphData.size() > 0)
		{
			for (int x_pos = 0; x_pos < SearchGraphData.size(); x_pos++)
			{
				xPos[x_pos] = x_pos;// (double)(stoi(SearchGraphData.at(x_pos).mainDT.DATE) - (search.StartDate[0] / 100) * 1000000) + (double)(stoi(SearchGraphData.at(x_pos).mainDT.TIME) / 1000000);

				TemperatureGraphNow[x_pos] = SearchGraphData.at(x_pos).mainDT.TEMP_AMB / 10;
				if (SearchGraphData.at(x_pos).mainDT.TEMP_AMB > 1500)
					TemperatureGraphNow[x_pos] = 0;
				if (SearchGraphData.at(x_pos).mainDT.TEMP_AMB < -250)
					TemperatureGraphNow[x_pos] = 0;

				TemperatureGraphSet[x_pos] = SearchGraphData.at(x_pos).mainDT.TEMP_AMB / 10;
				if (SearchGraphData.at(x_pos).mainDT.TEMP_TGT > 1500)
					TemperatureGraphSet[x_pos] = 0;
				if (SearchGraphData.at(x_pos).mainDT.TEMP_TGT < -250)
					TemperatureGraphSet[x_pos] = 0;

				HumidifyGraphNow[x_pos] = SearchGraphData.at(x_pos).mainDT.TEMP_AMB / 10;
				if (SearchGraphData.at(x_pos).mainDT.HUMI_AMB > 1000)
					HumidifyGraphNow[x_pos] = 0;
				if (SearchGraphData.at(x_pos).mainDT.HUMI_AMB < 0)
					HumidifyGraphNow[x_pos] = 0;

				HumidifyGraphSet[x_pos] = SearchGraphData.at(x_pos).mainDT.TEMP_AMB / 10;
				if (SearchGraphData.at(x_pos).mainDT.HUMI_TGT > 1000)
					HumidifyGraphSet[x_pos] = 0;
				if (SearchGraphData.at(x_pos).mainDT.HUMI_TGT < 0)
					HumidifyGraphSet[x_pos] = 0;

				LampPresetGraphNow[x_pos] = SearchGraphData.at(x_pos).mainDT.WATTS / 10;
				if (SearchGraphData.at(x_pos).mainDT.WATTS > 1000)
					LampPresetGraphNow[x_pos] = 0;
				if (SearchGraphData.at(x_pos).mainDT.WATTS < 0)
					LampPresetGraphNow[x_pos] = 0;

				DO1Graph[x_pos] = SearchGraphData.at(x_pos).mainDT.DO1 * 100;
				if (SearchGraphData.at(x_pos).mainDT.DO1 > 1)
					DO1Graph[x_pos] = 0;
				if (SearchGraphData.at(x_pos).mainDT.DO1 < 0)
					DO1Graph[x_pos] = 0;

				DO2Graph[x_pos] = SearchGraphData.at(x_pos).mainDT.DO2 * 100;
				if (SearchGraphData.at(x_pos).mainDT.DO2 > 1)
					DO2Graph[x_pos] = 0;
				if (SearchGraphData.at(x_pos).mainDT.DO2 < 0)
					DO2Graph[x_pos] = 0;

				DO3Graph[x_pos] = SearchGraphData.at(x_pos).mainDT.DO3 * 100;
				if (SearchGraphData.at(x_pos).mainDT.DO3 > 1)
					DO3Graph[x_pos] = 0;
				if (SearchGraphData.at(x_pos).mainDT.DO3 < 0)
					DO3Graph[x_pos] = 0;

				DO4Graph[x_pos] = SearchGraphData.at(x_pos).mainDT.DO4 * 100;
				if (SearchGraphData.at(x_pos).mainDT.DO4 > 1)
					DO4Graph[x_pos] = 0;
				if (SearchGraphData.at(x_pos).mainDT.DO4 < 0)
					DO4Graph[x_pos] = 0;

				DO5Graph[x_pos] = SearchGraphData.at(x_pos).mainDT.DO5 * 100;
				if (SearchGraphData.at(x_pos).mainDT.DO5 > 1)
					DO5Graph[x_pos] = 0;
				if (SearchGraphData.at(x_pos).mainDT.DO5 < 0)
					DO5Graph[x_pos] = 0;
			}

			graph.axesSearchGraph = CvPlot::makePlotAxes();
			graph.axesSearchSaveGraph = CvPlot::makePlotAxes();

			if (search.AmbTemp)
				graph.axesSearchGraph.create<CvPlot::Series>(xPos, TemperatureGraphNow, "-r");
			if (search.TarTemp)
				graph.axesSearchGraph.create<CvPlot::Series>(xPos, TemperatureGraphSet, "-s");
			if (search.AmbHumi)
				graph.axesSearchGraph.create<CvPlot::Series>(xPos, HumidifyGraphNow, "-b");
			if (search.TarHumi)
				graph.axesSearchGraph.create<CvPlot::Series>(xPos, HumidifyGraphSet, "-a");
			if (search.LampPre)
				graph.axesSearchGraph.create<CvPlot::Series>(xPos, LampPresetGraphNow, "-y");
			if (search.DO[0])
				graph.axesSearchGraph.create<CvPlot::Series>(xPos, DO1Graph, "-1");
			if (search.DO[1])
				graph.axesSearchGraph.create<CvPlot::Series>(xPos, DO2Graph, "-2");
			if (search.DO[2])
				graph.axesSearchGraph.create<CvPlot::Series>(xPos, DO3Graph, "-3");
			if (search.DO[3])
				graph.axesSearchGraph.create<CvPlot::Series>(xPos, DO4Graph, "-4");
			if (search.DO[4])
				graph.axesSearchGraph.create<CvPlot::Series>(xPos, DO5Graph, "-5");
			graph.axesSearchSaveGraph.create<CvPlot::Series>(xPos, TemperatureGraphNow, "-r");
			graph.axesSearchSaveGraph.create<CvPlot::Series>(xPos, TemperatureGraphSet, "-s");
			graph.axesSearchSaveGraph.create<CvPlot::Series>(xPos, HumidifyGraphNow, "-b");
			graph.axesSearchSaveGraph.create<CvPlot::Series>(xPos, HumidifyGraphSet, "-a");
			graph.axesSearchSaveGraph.create<CvPlot::Series>(xPos, LampPresetGraphNow, "-y");
			graph.axesSearchSaveGraph.create<CvPlot::Series>(xPos, DO1Graph, "-1");
			graph.axesSearchSaveGraph.create<CvPlot::Series>(xPos, DO2Graph, "-2");
			graph.axesSearchSaveGraph.create<CvPlot::Series>(xPos, DO3Graph, "-3");
			graph.axesSearchSaveGraph.create<CvPlot::Series>(xPos, DO4Graph, "-4");
			graph.axesSearchSaveGraph.create<CvPlot::Series>(xPos, DO5Graph, "-5");
			cv::Mat seeSearchGraph = graph.axesSearchGraph.render(787 - 125, 1822 - 96);
			graph.exportGraph = graph.axesSearchSaveGraph.render(787 - 125, 1822 - 96);
			SearchGraphData.clear();
			xPos.clear();
			TemperatureGraphNow.clear();
			TemperatureGraphSet.clear();
			HumidifyGraphNow.clear();
			HumidifyGraphSet.clear();
			LampPresetGraphNow.clear();
			DO1Graph.clear();
			DO2Graph.clear();
			DO3Graph.clear();
			DO4Graph.clear();
			DO5Graph.clear();
			return seeSearchGraph;
		}
	}
}
